Starting ANLI preprocessing job...
INFO:__main__:Running mode: preprocess
INFO:__main__:Selected model type: baseline-1
INFO:__main__:Selected dataset: ANLI
INFO:__main__:Using device: cuda
INFO:__main__:Starting preprocessing...
2025-05-05 20:12:50,187 - TextPreprocessor - INFO - [preprocessor.py:126] - Initializing Stanza pipeline. GPU available: True, Num Threads: 4
2025-05-05 20:12:57,499 - TextPreprocessor - INFO - [preprocessor.py:135] - Stanza pipeline initialized with processors: tokenize,pos,lemma,depparse,constituency
2025-05-05 20:12:57,583 - TextPreprocessor - INFO - [preprocessor.py:311] - Starting preprocessing pipeline for ANLI. Sample size: None. Force reprocess: True
2025-05-05 20:12:57,583 - TextPreprocessor - INFO - [preprocessor.py:336] - No total sample size provided or zero, processing full splits.
2025-05-05 20:12:57,583 - TextPreprocessor - INFO - [preprocessor.py:340] - --- Processing split: train ---
INFO:data.data_loader:Loading dataset: ANLI (HF: facebook/anli), Split: train
INFO:data.data_loader:Loading from HuggingFace: facebook/anli, split: train_r1
INFO:data.data_loader:ANLI dataset: Loading rounds ['r1', 'r2', 'r3'] for split train_r1
WARNING:data.data_loader:Could not load ANLI split 'train_r1_r1': Unknown split "train_r1_r1". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
WARNING:data.data_loader:Could not load ANLI split 'train_r1_r2': Unknown split "train_r1_r2". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
WARNING:data.data_loader:Could not load ANLI split 'train_r1_r3': Unknown split "train_r1_r3". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
ERROR:data.data_loader:Failed to load any rounds for ANLI split train_r1
WARNING:data.data_loader:DataFrame is empty for ANLI/train (HF split: train_r1) after loading/conversion.
ERROR:data.data_loader:Failed to load any data for dataset 'ANLI' (Split: train). Returning empty DataFrame.
2025-05-05 20:13:09,079 - TextPreprocessor - WARNING - [preprocessor.py:351] - No data loaded for ANLI/train. Skipping this split.
2025-05-05 20:13:09,079 - TextPreprocessor - INFO - [preprocessor.py:340] - --- Processing split: validation ---
INFO:data.data_loader:Loading dataset: ANLI (HF: facebook/anli), Split: validation
INFO:data.data_loader:Loading from HuggingFace: facebook/anli, split: dev_r1
INFO:data.data_loader:ANLI dataset: Loading rounds ['r1', 'r2', 'r3'] for split dev_r1
WARNING:data.data_loader:Could not load ANLI split 'dev_r1_r1': Unknown split "dev_r1_r1". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
WARNING:data.data_loader:Could not load ANLI split 'dev_r1_r2': Unknown split "dev_r1_r2". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
WARNING:data.data_loader:Could not load ANLI split 'dev_r1_r3': Unknown split "dev_r1_r3". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
ERROR:data.data_loader:Failed to load any rounds for ANLI split dev_r1
WARNING:data.data_loader:DataFrame is empty for ANLI/validation (HF split: dev_r1) after loading/conversion.
ERROR:data.data_loader:Failed to load any data for dataset 'ANLI' (Split: validation). Returning empty DataFrame.
2025-05-05 20:13:16,981 - TextPreprocessor - WARNING - [preprocessor.py:351] - No data loaded for ANLI/validation. Skipping this split.
2025-05-05 20:13:16,981 - TextPreprocessor - INFO - [preprocessor.py:340] - --- Processing split: test ---
INFO:data.data_loader:Loading dataset: ANLI (HF: facebook/anli), Split: test
INFO:data.data_loader:Loading from HuggingFace: facebook/anli, split: test_r1
INFO:data.data_loader:ANLI dataset: Loading rounds ['r1', 'r2', 'r3'] for split test_r1
WARNING:data.data_loader:Could not load ANLI split 'test_r1_r1': Unknown split "test_r1_r1". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
WARNING:data.data_loader:Could not load ANLI split 'test_r1_r2': Unknown split "test_r1_r2". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
WARNING:data.data_loader:Could not load ANLI split 'test_r1_r3': Unknown split "test_r1_r3". Should be one of ['train_r1', 'dev_r1', 'test_r1', 'train_r2', 'dev_r2', 'test_r2', 'train_r3', 'dev_r3', 'test_r3'].
ERROR:data.data_loader:Failed to load any rounds for ANLI split test_r1
WARNING:data.data_loader:DataFrame is empty for ANLI/test (HF split: test_r1) after loading/conversion.
ERROR:data.data_loader:Failed to load any data for dataset 'ANLI' (Split: test). Returning empty DataFrame.
2025-05-05 20:13:24,978 - TextPreprocessor - WARNING - [preprocessor.py:351] - No data loaded for ANLI/test. Skipping this split.
2025-05-05 20:13:24,978 - TextPreprocessor - INFO - [preprocessor.py:428] - Completed preprocessing pipeline for ANLI
INFO:__main__:Preprocessing finished.
ANLI preprocessing job finished.
