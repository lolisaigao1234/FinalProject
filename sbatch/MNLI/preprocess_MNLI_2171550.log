Starting MNLI preprocessing job...
2025-05-11 19:12:32,361 - datasets - INFO - [config.py:54] - PyTorch version 2.6.0+cu126 available.
2025-05-11 19:12:37,703 - __main__ - INFO - [main.py:47] - Running mode: preprocess
2025-05-11 19:12:37,703 - __main__ - INFO - [main.py:48] - Selected model type: baseline-1
2025-05-11 19:12:37,703 - __main__ - INFO - [main.py:49] - Selected dataset: MNLI
2025-05-11 19:12:37,703 - __main__ - INFO - [main.py:50] - Using device: cuda
2025-05-11 19:12:37,703 - __main__ - INFO - [main.py:52] - Using sample size: 10000
2025-05-11 19:12:37,703 - __main__ - INFO - [main.py:60] - Starting preprocessing...
2025-05-11 19:12:37,703 - TextPreprocessor - INFO - [preprocessor.py:126] - Initializing Stanza pipeline. GPU available: True, Num Threads: 4
2025-05-11 19:12:47,699 - TextPreprocessor - INFO - [preprocessor.py:135] - Stanza pipeline initialized with processors: tokenize,pos,lemma,depparse,constituency
2025-05-11 19:12:47,700 - TextPreprocessor - INFO - [preprocessor.py:311] - Starting preprocessing pipeline for MNLI. Sample size: 10000. Force reprocess: True
2025-05-11 19:12:47,700 - TextPreprocessor - INFO - [preprocessor.py:334] - Calculated target sample sizes: {'train': 8000, 'validation': 1000, 'test': 1000}
2025-05-11 19:12:47,700 - TextPreprocessor - INFO - [preprocessor.py:340] - --- Processing split: train ---
2025-05-11 19:12:47,700 - data.data_loader - INFO - [data_loader.py:164] - Loading dataset: MNLI (HF: nyu-mll/multi_nli), Requested standard split: train
2025-05-11 19:12:47,701 - data.data_loader - INFO - [data_loader.py:198] - Attempting to load processed MNLI/train from DB table: raw_data_train_full
2025-05-11 19:12:47,702 - utils.database - INFO - [database.py:80] - Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/raw_data_train_full.parquet
2025-05-11 19:12:54,828 - data.data_loader - INFO - [data_loader.py:203] - Successfully loaded MNLI/train from DB. Shape: (392702, 12)
2025-05-11 19:12:54,834 - TextPreprocessor - INFO - [preprocessor.py:372] - Sampling 8000 examples for train (from 392702) for suffix 'sample8000'.
2025-05-11 19:12:54,952 - TextPreprocessor - INFO - [preprocessor.py:411] - Using suffix 'sample8000' for MNLI/train
2025-05-11 19:12:54,952 - utils.database - INFO - [database.py:104] - Saving intermediate dataframe (raw_input_sample8000) to /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/raw_input_sample8000.parquet
2025-05-11 19:12:55,094 - utils.database - INFO - [database.py:107] - Saved dataframe to /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/raw_input_sample8000.parquet
2025-05-11 19:12:55,095 - TextPreprocessor - INFO - [preprocessor.py:416] - Stored raw input data for processing: raw_input_sample8000
2025-05-11 19:12:55,095 - TextPreprocessor - INFO - [preprocessor.py:160] - Processing MNLI / train (Suffix: sample8000)
2025-05-11 19:12:55,095 - TextPreprocessor - INFO - [preprocessor.py:287] - Preparing sentence pairs for MNLI/train
2025-05-11 19:12:55,362 - TextPreprocessor - INFO - [preprocessor.py:298] - Created 8000 pairs and 15820 unique sentences.
2025-05-11 19:12:55,363 - utils.database - INFO - [database.py:104] - Saving intermediate dataframe (pairs_sample8000) to /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/pairs_sample8000.parquet
2025-05-11 19:12:55,397 - utils.database - INFO - [database.py:107] - Saved dataframe to /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/pairs_sample8000.parquet
2025-05-11 19:12:55,397 - utils.database - INFO - [database.py:104] - Saving intermediate dataframe (sentences_sample8000) to /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/sentences_sample8000.parquet
2025-05-11 19:12:55,696 - utils.database - INFO - [database.py:107] - Saved dataframe to /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/sentences_sample8000.parquet
2025-05-11 19:12:55,696 - TextPreprocessor - INFO - [preprocessor.py:177] - Stored intermediate data: pairs_sample8000, sentences_sample8000
2025-05-11 19:12:55,696 - TextPreprocessor - INFO - [preprocessor.py:181] - Running syntactic parsing (preprocess_dataset) for 15820 sentences (sample8000)
2025-05-11 19:12:55,696 - TextPreprocessor - INFO - [preprocessor.py:252] - Running preprocess_dataset (Stanza Parsing) for MNLI/train. Force: True
2025-05-11 19:12:55,697 - utils.database - INFO - [database.py:80] - Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/sentences_sample8000.parquet
2025-05-11 19:12:55,709 - TextPreprocessor - INFO - [preprocessor.py:212] - Processing Stanza for MNLI/train/parse_trees_sample8000
2025-05-11 19:12:55,709 - TextPreprocessor - INFO - [preprocessor.py:456] - Processing 15820 sentences with Stanza...
Stanza Parsing (sample8000):   0%|          | 0/15820 [00:00<?, ?it/s]Stanza Parsing (sample8000):   0%|          | 1/15820 [00:01<5:45:22,  1.31s/it]Stanza Parsing (sample8000):   0%|          | 3/15820 [00:01<1:40:49,  2.61it/s]Stanza Parsing (sample8000):   0%|          | 5/15820 [00:01<1:00:21,  4.37it/s]Stanza Parsing (sample8000):   0%|          | 7/15820 [00:01<46:55,  5.62it/s]  Stanza Parsing (sample8000):   0%|          | 9/15820 [00:02<39:02,  6.75it/s]Stanza Parsing (sample8000):   0%|          | 11/15820 [00:02<37:11,  7.08it/s]Stanza Parsing (sample8000):   0%|          | 12/15820 [00:02<39:47,  6.62it/s]Stanza Parsing (sample8000):   0%|          | 13/15820 [00:02<39:19,  6.70it/s]Stanza Parsing (sample8000):   0%|          | 15/15820 [00:02<29:50,  8.82it/s]Stanza Parsing (sample8000):   0%|          | 17/15820 [00:03<37:03,  7.11it/s]Stanza Parsing (sample8000):   0%|          | 19/15820 [00:03<31:43,  8.30it/s]Stanza Parsing (sample8000):   0%|          | 21/15820 [00:03<28:42,  9.17it/s]Stanza Parsing (sample8000):   0%|          | 23/15820 [00:04<45:30,  5.79it/s]Stanza Parsing (sample8000):   0%|          | 25/15820 [00:04<36:15,  7.26it/s]Stanza Parsing (sample8000):   0%|          | 27/15820 [00:04<31:46,  8.28it/s]Stanza Parsing (sample8000):   0%|          | 29/15820 [00:04<31:52,  8.26it/s]Stanza Parsing (sample8000):   0%|          | 31/15820 [00:04<31:16,  8.41it/s]Stanza Parsing (sample8000):   0%|          | 33/15820 [00:04<26:24,  9.97it/s]Stanza Parsing (sample8000):   0%|          | 35/15820 [00:05<23:49, 11.04it/s]Stanza Parsing (sample8000):   0%|          | 37/15820 [00:05<22:18, 11.79it/s]Stanza Parsing (sample8000):   0%|          | 39/15820 [00:05<20:50, 12.62it/s]Stanza Parsing (sample8000):   0%|          | 41/15820 [00:05<22:19, 11.78it/s]Stanza Parsing (sample8000):   0%|          | 43/15820 [00:05<21:36, 12.17it/s]Stanza Parsing (sample8000):   0%|          | 45/15820 [00:05<24:12, 10.86it/s]Stanza Parsing (sample8000):   0%|          | 47/15820 [00:06<21:47, 12.07it/s]Stanza Parsing (sample8000):   0%|          | 49/15820 [00:06<22:34, 11.64it/s]Stanza Parsing (sample8000):   0%|          | 51/15820 [00:06<23:31, 11.17it/s]Stanza Parsing (sample8000):   0%|          | 53/15820 [00:06<24:00, 10.94it/s]Stanza Parsing (sample8000):   0%|          | 55/15820 [00:06<21:08, 12.42it/s]Stanza Parsing (sample8000):   0%|          | 57/15820 [00:06<19:33, 13.43it/s]Stanza Parsing (sample8000):   0%|          | 59/15820 [00:07<21:21, 12.30it/s]Stanza Parsing (sample8000):   0%|          | 61/15820 [00:07<25:36, 10.26it/s]Stanza Parsing (sample8000):   0%|          | 63/15820 [00:07<24:47, 10.59it/s]Stanza Parsing (sample8000):   0%|          | 65/15820 [00:07<27:11,  9.66it/s]Stanza Parsing (sample8000):   0%|          | 67/15820 [00:07<27:32,  9.54it/s]Stanza Parsing (sample8000):   0%|          | 69/15820 [00:08<24:14, 10.83it/s]Stanza Parsing (sample8000):   0%|          | 71/15820 [00:08<23:45, 11.05it/s]Stanza Parsing (sample8000):   0%|          | 73/15820 [00:08<25:57, 10.11it/s]Stanza Parsing (sample8000):   0%|          | 75/15820 [00:08<27:47,  9.44it/s]Stanza Parsing (sample8000):   0%|          | 77/15820 [00:08<26:29,  9.91it/s]Stanza Parsing (sample8000):   0%|          | 79/15820 [00:09<31:04,  8.44it/s]Stanza Parsing (sample8000):   1%|          | 80/15820 [00:09<41:19,  6.35it/s]Stanza Parsing (sample8000):   1%|          | 82/15820 [00:09<35:11,  7.45it/s]Stanza Parsing (sample8000):   1%|          | 84/15820 [00:09<29:22,  8.93it/s]Stanza Parsing (sample8000):   1%|          | 86/15820 [00:10<26:37,  9.85it/s]Stanza Parsing (sample8000):   1%|          | 88/15820 [00:10<29:28,  8.90it/s]Stanza Parsing (sample8000):   1%|          | 90/15820 [00:10<30:49,  8.50it/s]Stanza Parsing (sample8000):   1%|          | 92/15820 [00:10<28:00,  9.36it/s]Stanza Parsing (sample8000):   1%|          | 94/15820 [00:10<27:10,  9.65it/s]Stanza Parsing (sample8000):   1%|          | 96/15820 [00:11<27:05,  9.67it/s]Stanza Parsing (sample8000):   1%|          | 98/15820 [00:11<23:47, 11.01it/s]Stanza Parsing (sample8000):   1%|          | 100/15820 [00:11<28:26,  9.21it/s]Stanza Parsing (sample8000):   1%|          | 102/15820 [00:11<34:04,  7.69it/s]Stanza Parsing (sample8000):   1%|          | 104/15820 [00:12<31:33,  8.30it/s]Stanza Parsing (sample8000):   1%|          | 107/15820 [00:12<27:08,  9.65it/s]Stanza Parsing (sample8000):   1%|          | 109/15820 [00:12<23:49, 10.99it/s]Stanza Parsing (sample8000):   1%|          | 111/15820 [00:12<23:52, 10.97it/s]Stanza Parsing (sample8000):   1%|          | 113/15820 [00:12<26:39,  9.82it/s]Stanza Parsing (sample8000):   1%|          | 115/15820 [00:13<29:09,  8.98it/s]Stanza Parsing (sample8000):   1%|          | 116/15820 [00:13<30:39,  8.53it/s]Stanza Parsing (sample8000):   1%|          | 118/15820 [00:13<27:42,  9.44it/s]Stanza Parsing (sample8000):   1%|          | 119/15820 [00:13<28:56,  9.04it/s]Stanza Parsing (sample8000):   1%|          | 120/15820 [00:13<30:25,  8.60it/s]Stanza Parsing (sample8000):   1%|          | 122/15820 [00:13<26:48,  9.76it/s]Stanza Parsing (sample8000):   1%|          | 124/15820 [00:14<26:00, 10.06it/s]Stanza Parsing (sample8000):   1%|          | 126/15820 [00:14<21:43, 12.04it/s]Stanza Parsing (sample8000):   1%|          | 128/15820 [00:14<22:44, 11.50it/s]Stanza Parsing (sample8000):   1%|          | 130/15820 [00:14<22:45, 11.49it/s]Stanza Parsing (sample8000):   1%|          | 132/15820 [00:14<24:10, 10.81it/s]Stanza Parsing (sample8000):   1%|          | 134/15820 [00:15<50:38,  5.16it/s]Stanza Parsing (sample8000):   1%|          | 136/15820 [00:15<40:30,  6.45it/s]Stanza Parsing (sample8000):   1%|          | 138/15820 [00:15<35:11,  7.43it/s]Stanza Parsing (sample8000):   1%|          | 140/15820 [00:16<31:22,  8.33it/s]Stanza Parsing (sample8000):   1%|          | 142/15820 [00:16<30:54,  8.45it/s]Stanza Parsing (sample8000):   1%|          | 144/15820 [00:16<27:16,  9.58it/s]Stanza Parsing (sample8000):   1%|          | 146/15820 [00:16<28:39,  9.11it/s]Stanza Parsing (sample8000):   1%|          | 148/15820 [00:16<27:41,  9.43it/s]Stanza Parsing (sample8000):   1%|          | 150/15820 [00:17<23:57, 10.90it/s]Stanza Parsing (sample8000):   1%|          | 152/15820 [00:17<21:00, 12.43it/s]Stanza Parsing (sample8000):   1%|          | 154/15820 [00:17<20:39, 12.64it/s]Stanza Parsing (sample8000):   1%|          | 156/15820 [00:17<21:50, 11.95it/s]Stanza Parsing (sample8000):   1%|          | 158/15820 [00:17<21:10, 12.33it/s]Stanza Parsing (sample8000):   1%|          | 160/15820 [00:18<53:52,  4.84it/s]Stanza Parsing (sample8000):   1%|          | 161/15820 [00:19<1:06:47,  3.91it/s]Stanza Parsing (sample8000):   1%|          | 162/15820 [00:19<59:56,  4.35it/s]  Stanza Parsing (sample8000):   1%|          | 164/15820 [00:19<45:37,  5.72it/s]Stanza Parsing (sample8000):   1%|          | 166/15820 [00:19<37:48,  6.90it/s]Stanza Parsing (sample8000):   1%|          | 168/15820 [00:19<31:17,  8.34it/s]Stanza Parsing (sample8000):   1%|          | 170/15820 [00:19<26:02, 10.02it/s]Stanza Parsing (sample8000):   1%|          | 172/15820 [00:19<25:27, 10.24it/s]Stanza Parsing (sample8000):   1%|          | 174/15820 [00:20<29:25,  8.86it/s]Stanza Parsing (sample8000):   1%|          | 176/15820 [00:20<26:26,  9.86it/s]Stanza Parsing (sample8000):   1%|          | 178/15820 [00:20<22:35, 11.54it/s]Stanza Parsing (sample8000):   1%|          | 180/15820 [00:20<22:42, 11.48it/s]Stanza Parsing (sample8000):   1%|          | 182/15820 [00:20<23:04, 11.30it/s]Stanza Parsing (sample8000):   1%|          | 184/15820 [00:21<23:14, 11.21it/s]Stanza Parsing (sample8000):   1%|          | 186/15820 [00:21<24:45, 10.52it/s]Stanza Parsing (sample8000):   1%|          | 188/15820 [00:21<24:43, 10.54it/s]Stanza Parsing (sample8000):   1%|          | 190/15820 [00:21<31:31,  8.27it/s]Stanza Parsing (sample8000):   1%|          | 192/15820 [00:22<31:28,  8.28it/s]Stanza Parsing (sample8000):   1%|          | 194/15820 [00:22<27:59,  9.31it/s]Stanza Parsing (sample8000):   1%|          | 196/15820 [00:22<27:09,  9.59it/s]Stanza Parsing (sample8000):   1%|▏         | 198/15820 [00:22<24:21, 10.69it/s]Stanza Parsing (sample8000):   1%|▏         | 200/15820 [00:22<22:07, 11.76it/s]Stanza Parsing (sample8000):   1%|▏         | 202/15820 [00:23<40:40,  6.40it/s]Stanza Parsing (sample8000):   1%|▏         | 204/15820 [00:23<33:48,  7.70it/s]Stanza Parsing (sample8000):   1%|▏         | 206/15820 [00:23<28:01,  9.29it/s]Stanza Parsing (sample8000):   1%|▏         | 208/15820 [00:23<28:11,  9.23it/s]Stanza Parsing (sample8000):   1%|▏         | 210/15820 [00:23<26:39,  9.76it/s]Stanza Parsing (sample8000):   1%|▏         | 212/15820 [00:24<24:24, 10.66it/s]Stanza Parsing (sample8000):   1%|▏         | 214/15820 [00:24<25:48, 10.08it/s]Stanza Parsing (sample8000):   1%|▏         | 216/15820 [00:24<28:16,  9.20it/s]Stanza Parsing (sample8000):   1%|▏         | 218/15820 [00:25<34:50,  7.46it/s]Stanza Parsing (sample8000):   1%|▏         | 219/15820 [00:25<34:33,  7.52it/s]Stanza Parsing (sample8000):   1%|▏         | 220/15820 [00:25<42:25,  6.13it/s]Stanza Parsing (sample8000):   1%|▏         | 221/15820 [00:25<41:00,  6.34it/s]Stanza Parsing (sample8000):   1%|▏         | 223/15820 [00:25<31:31,  8.24it/s]Stanza Parsing (sample8000):   1%|▏         | 224/15820 [00:25<30:29,  8.52it/s]Stanza Parsing (sample8000):   1%|▏         | 225/15820 [00:25<30:54,  8.41it/s]Stanza Parsing (sample8000):   1%|▏         | 227/15820 [00:26<28:10,  9.22it/s]Stanza Parsing (sample8000):   1%|▏         | 228/15820 [00:26<27:44,  9.37it/s]Stanza Parsing (sample8000):   1%|▏         | 230/15820 [00:26<24:38, 10.55it/s]Stanza Parsing (sample8000):   1%|▏         | 232/15820 [00:26<22:42, 11.44it/s]Stanza Parsing (sample8000):   1%|▏         | 234/15820 [00:26<21:25, 12.12it/s]Stanza Parsing (sample8000):   1%|▏         | 236/15820 [00:26<22:08, 11.73it/s]Stanza Parsing (sample8000):   2%|▏         | 238/15820 [00:27<22:26, 11.57it/s]Stanza Parsing (sample8000):   2%|▏         | 240/15820 [00:27<27:36,  9.40it/s]Stanza Parsing (sample8000):   2%|▏         | 242/15820 [00:27<30:18,  8.56it/s]Stanza Parsing (sample8000):   2%|▏         | 244/15820 [00:27<30:12,  8.59it/s]Stanza Parsing (sample8000):   2%|▏         | 245/15820 [00:29<1:30:41,  2.86it/s]Stanza Parsing (sample8000):   2%|▏         | 246/15820 [00:29<1:19:44,  3.26it/s]Stanza Parsing (sample8000):   2%|▏         | 248/15820 [00:29<1:10:49,  3.66it/s]Stanza Parsing (sample8000):   2%|▏         | 249/15820 [00:29<1:01:45,  4.20it/s]Stanza Parsing (sample8000):   2%|▏         | 250/15820 [00:30<54:21,  4.77it/s]  Stanza Parsing (sample8000):   2%|▏         | 251/15820 [00:30<48:49,  5.32it/s]Stanza Parsing (sample8000):   2%|▏         | 253/15820 [00:30<36:04,  7.19it/s]Stanza Parsing (sample8000):   2%|▏         | 254/15820 [00:30<36:54,  7.03it/s]Stanza Parsing (sample8000):   2%|▏         | 255/15820 [00:30<37:21,  6.94it/s]Stanza Parsing (sample8000):   2%|▏         | 257/15820 [00:30<30:03,  8.63it/s]Stanza Parsing (sample8000):   2%|▏         | 259/15820 [00:30<26:11,  9.90it/s]Stanza Parsing (sample8000):   2%|▏         | 261/15820 [00:31<30:00,  8.64it/s]Stanza Parsing (sample8000):   2%|▏         | 262/15820 [00:31<30:35,  8.47it/s]Stanza Parsing (sample8000):   2%|▏         | 264/15820 [00:31<29:28,  8.80it/s]Stanza Parsing (sample8000):   2%|▏         | 266/15820 [00:31<25:02, 10.35it/s]Stanza Parsing (sample8000):   2%|▏         | 268/15820 [00:31<26:06,  9.93it/s]Stanza Parsing (sample8000):   2%|▏         | 270/15820 [00:32<29:50,  8.68it/s]Stanza Parsing (sample8000):   2%|▏         | 272/15820 [00:32<26:24,  9.81it/s]Stanza Parsing (sample8000):   2%|▏         | 274/15820 [00:32<27:02,  9.58it/s]Stanza Parsing (sample8000):   2%|▏         | 276/15820 [00:32<28:36,  9.06it/s]Stanza Parsing (sample8000):   2%|▏         | 277/15820 [00:32<29:27,  8.79it/s]Stanza Parsing (sample8000):   2%|▏         | 278/15820 [00:33<31:00,  8.35it/s]Stanza Parsing (sample8000):   2%|▏         | 279/15820 [00:33<39:06,  6.62it/s]Stanza Parsing (sample8000):   2%|▏         | 281/15820 [00:33<31:00,  8.35it/s]Stanza Parsing (sample8000):   2%|▏         | 282/15820 [00:33<33:40,  7.69it/s]Stanza Parsing (sample8000):   2%|▏         | 284/15820 [00:33<30:13,  8.57it/s]Stanza Parsing (sample8000):   2%|▏         | 285/15820 [00:33<33:58,  7.62it/s]Stanza Parsing (sample8000):   2%|▏         | 287/15820 [00:34<30:32,  8.48it/s]Stanza Parsing (sample8000):   2%|▏         | 289/15820 [00:34<27:08,  9.54it/s]Stanza Parsing (sample8000):   2%|▏         | 290/15820 [00:34<29:15,  8.84it/s]Stanza Parsing (sample8000):   2%|▏         | 292/15820 [00:34<32:58,  7.85it/s]Stanza Parsing (sample8000):   2%|▏         | 294/15820 [00:35<31:42,  8.16it/s]Stanza Parsing (sample8000):   2%|▏         | 295/15820 [00:35<30:58,  8.35it/s]Stanza Parsing (sample8000):   2%|▏         | 296/15820 [00:35<33:15,  7.78it/s]Stanza Parsing (sample8000):   2%|▏         | 297/15820 [00:35<33:23,  7.75it/s]Stanza Parsing (sample8000):   2%|▏         | 298/15820 [00:35<34:48,  7.43it/s]Stanza Parsing (sample8000):   2%|▏         | 300/15820 [00:35<29:49,  8.67it/s]Stanza Parsing (sample8000):   2%|▏         | 303/15820 [00:35<20:44, 12.47it/s]Stanza Parsing (sample8000):   2%|▏         | 305/15820 [00:36<21:58, 11.77it/s]Stanza Parsing (sample8000):   2%|▏         | 307/15820 [00:36<23:58, 10.79it/s]Stanza Parsing (sample8000):   2%|▏         | 309/15820 [00:36<25:02, 10.32it/s]Stanza Parsing (sample8000):   2%|▏         | 311/15820 [00:36<22:43, 11.37it/s]Stanza Parsing (sample8000):   2%|▏         | 313/15820 [00:36<24:13, 10.67it/s]Stanza Parsing (sample8000):   2%|▏         | 315/15820 [00:36<21:16, 12.15it/s]Stanza Parsing (sample8000):   2%|▏         | 317/15820 [00:37<19:59, 12.92it/s]Stanza Parsing (sample8000):   2%|▏         | 319/15820 [00:37<20:49, 12.41it/s]Stanza Parsing (sample8000):   2%|▏         | 321/15820 [00:37<23:03, 11.20it/s]Stanza Parsing (sample8000):   2%|▏         | 323/15820 [00:37<22:55, 11.27it/s]Stanza Parsing (sample8000):   2%|▏         | 325/15820 [00:37<21:02, 12.27it/s]Stanza Parsing (sample8000):   2%|▏         | 327/15820 [00:37<20:25, 12.64it/s]