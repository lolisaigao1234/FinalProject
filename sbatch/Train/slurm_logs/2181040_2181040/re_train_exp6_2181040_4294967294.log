------------------------------------------------
SLURM Job ID: 2181040
SLURM Array Job ID: 
SLURM Array Task ID:  / 3
Running on host: ccc0291.campuscluster.illinois.edu
Node allocated: ccc[0291,0293]
Requested CPUs: 1
Running Dataset: ANLI
Running Experiment: experiment-6
Sample Size: 10000 (8000 train, 1000 validation, 1000 test)
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated: /sw/apps/anaconda3/2024.10/bin/python
OMP_NUM_THREADS set to 1
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for ANLI / experiment-6 (Task ID )...
2025-05-12 13:46:19,616 - datasets - INFO - [config.py:54] - PyTorch version 2.6.0+cu126 available.
2025-05-12 13:46:29,741 - __main__ - INFO - [main.py:47] - Running mode: train
2025-05-12 13:46:29,741 - __main__ - INFO - [main.py:48] - Selected model type: experiment-6
2025-05-12 13:46:29,741 - __main__ - INFO - [main.py:49] - Selected dataset: ANLI
2025-05-12 13:46:29,741 - __main__ - INFO - [main.py:50] - Using device: cpu
2025-05-12 13:46:29,741 - __main__ - INFO - [main.py:52] - Using sample size: 10000
2025-05-12 13:46:29,741 - __main__ - INFO - [main.py:92] - Starting training for model: experiment-6
2025-05-12 13:46:30,037 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:55] - Initialized ExperimentTrainer for model key: 'experiment-6', class: GradientBoostingTFIDFSyntacticExperiment6, dataset: ANLI, suffix: sample10000
2025-05-12 13:46:30,037 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:71] - Initializing model instance for experiment-6 (GradientBoostingTFIDFSyntacticExperiment6)
2025-05-12 13:46:30,048 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:121] - Initialized GradientBoosting_TFIDF_Syntactic_Exp6 with params: {'n_estimators': 100, 'learning_rate': 3e-05, 'max_depth': None, 'random_state': 42, 'tfidf_max_features': 10000, 'tfidf_ngram_range': (1, 2), 'scale_syntactic': True}
2025-05-12 13:46:30,048 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:93] - Model experiment-6 initialized successfully.
2025-05-12 13:46:30,048 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:107] - --- Loading Pre-computed Features for experiment-6 on ANLI (train/sample10000) ---
2025-05-12 13:46:30,048 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:115] - Loading pre-computed features using SimpleParquetLoader...
2025-05-12 13:46:30,048 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:128] - Attempting to load feature file matching: dataset='ANLI', split='train', suffix='sample10000'
2025-05-12 13:46:30,048 - models.baseline_base - INFO - [baseline_base.py:622] - SimpleParquetLoader: Searching for features in cache/parquet/ANLI/train for ANLI/train/sample10000
2025-05-12 13:46:32,054 - models.baseline_base - INFO - [baseline_base.py:685] - SimpleParquetLoader: Loading final features from: cache/parquet/ANLI/train/ANLI_train_features_stats_syntactic_full.parquet
2025-05-12 13:46:33,187 - models.baseline_base - INFO - [baseline_base.py:687] - SimpleParquetLoader: Loaded 740653 rows from cache/parquet/ANLI/train/ANLI_train_features_stats_syntactic_full.parquet
2025-05-12 13:46:33,187 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:153] - Loaded 740653 rows with 253 columns from pre-computed feature file.
2025-05-12 13:46:33,191 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:163] - Feature data cleaned. 740653 samples remaining.
2025-05-12 13:46:33,191 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:172] - Extracting/Selecting features using experiment-6.extract_features...
2025-05-12 13:46:33,191 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:292] - GradientBoosting_TFIDF_Syntactic_Exp6: Fitting feature pipeline and transforming training data...
2025-05-12 13:46:33,191 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:232] - GradientBoosting_TFIDF_Syntactic_Exp6: Building unfitted feature pipeline...
2025-05-12 13:46:33,191 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:263] - Adding StandardScaler (via SparseScaler) for syntactic features.
2025-05-12 13:46:33,191 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:266] - Including 243 syntactic features in pipeline.
2025-05-12 13:46:33,191 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:277] - GradientBoosting_TFIDF_Syntactic_Exp6: Unfitted feature pipeline built.
2025-05-12 13:47:10,549 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:309] - Pipeline fit & transform complete in 37.36s. Shape: (740653, 10243)
2025-05-12 13:47:10,570 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:182] - Training features prepared. Shape: (740653, 10243)
2025-05-12 13:47:10,570 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:183] - Training labels prepared. Length: 740653
2025-05-12 13:47:10,696 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:194] - Data loading and preparation phase finished in 40.65s
2025-05-12 13:47:10,697 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:198] - --- Starting model training for experiment-6 on ANLI (sample10000) ---
2025-05-12 13:47:10,697 - models.gradient_boosting_tfidf_syntactic_experiment_6 - INFO - [gradient_boosting_tfidf_syntactic_experiment_6.py:347] - Converting sparse training data to dense for Gradient Boosting.
/var/spool/slurmd/job2181040/slurm_script: line 72: 268098 Killed                  python -u main.py --dataset "$CURRENT_DATASET" --mode train --model_type "$EXPERIMENT" --sample_size 10000 --fp16 --force_reprocess
Python script finished with exit code 137 for Task ID 
------------------------------------------------
Job Task  finished.
Total Runtime: 77 seconds
------------------------------------------------
slurmstepd: error: Detected 1 oom_kill event in StepId=2181040.batch. Some of the step tasks have been OOM Killed.
