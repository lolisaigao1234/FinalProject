/var/spool/slurmd/job2154744/slurm_script: line 46: [: : integer expression expected
/var/spool/slurmd/job2154744/slurm_script: line 46: [: : integer expression expected
------------------------------------------------
SLURM Job ID: 2154744
SLURM Array Job ID: 
SLURM Array Task ID:  / 33
Running on host: ccc0389.campuscluster.illinois.edu
Node allocated: ccc0389
Requested CPUs: 16
Running Dataset: SNLI
Running Experiment (Model Type): experiment-8
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated: /sw/apps/anaconda3/2024.10/bin/python
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for SNLI / experiment-8 (Task ID )...
2025-05-10 01:07:04,975 - datasets - INFO - [config.py:54] - PyTorch version 2.6.0+cu126 available.
2025-05-10 01:07:09,009 - __main__ - INFO - [main.py:47] - Running mode: train
2025-05-10 01:07:09,009 - __main__ - INFO - [main.py:48] - Selected model type: experiment-8
2025-05-10 01:07:09,010 - __main__ - INFO - [main.py:49] - Selected dataset: SNLI
2025-05-10 01:07:09,010 - __main__ - INFO - [main.py:50] - Using device: cuda
2025-05-10 01:07:09,010 - __main__ - INFO - [main.py:92] - Starting training for model: experiment-8
2025-05-10 01:07:09,010 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:72] - Experiment 8: No valid sample_size provided. Using suffix 'full'.
2025-05-10 01:07:09,011 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:164] - ===== Starting Experiment 8: Syntactic Feature Cross-Validation =====
2025-05-10 01:07:09,011 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:165] - Dataset: SNLI, Suffix used for loading: full, Folds: 5
2025-05-10 01:07:09,011 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:117] - Exp8: Loading precomputed features for SNLI/train/full
2025-05-10 01:07:09,055 - utils.database - INFO - [database.py:80] - Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/train/SNLI_train_features_stats_syntactic_full.parquet
2025-05-10 01:07:09,860 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:150] - Exp8: Using 240 syntactic features for cross-validation.
2025-05-10 01:07:10,200 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:182] - --- Running Cross-Validation for: DecisionTree ---
2025-05-10 01:07:36,654 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:209] - Finished CV for DecisionTree in 26.35s. Avg F1: 0.4047
2025-05-10 01:07:36,711 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:182] - --- Running Cross-Validation for: KNN ---
2025-05-10 01:11:18,698 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:209] - Finished CV for KNN in 221.99s. Avg F1: 0.3635
2025-05-10 01:11:18,726 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:182] - --- Running Cross-Validation for: LogisticRegression ---
2025-05-10 01:18:40,703 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:209] - Finished CV for LogisticRegression in 441.98s. Avg F1: 0.4935
2025-05-10 01:18:40,715 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:182] - --- Running Cross-Validation for: MultinomialNB ---
2025-05-10 01:18:43,520 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:209] - Finished CV for MultinomialNB in 2.80s. Avg F1: 0.4355
2025-05-10 01:18:43,521 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:182] - --- Running Cross-Validation for: RandomForest ---
2025-05-10 01:19:46,166 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:209] - Finished CV for RandomForest in 62.65s. Avg F1: 0.4721
2025-05-10 01:19:46,389 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:182] - --- Running Cross-Validation for: GradientBoosting ---
2025-05-10 05:37:35,773 - models.cross_validate_syntactic_experiment_8 - ERROR - [cross_validate_syntactic_experiment_8.py:214] - Error during cross-validation for GradientBoosting: A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.

The exit codes of the workers are {SIGKILL(-9)}
Traceback (most recent call last):
  File "/scratch/jywu3/IS567FP/models/cross_validate_syntactic_experiment_8.py", line 185, in run_experiment
    cv_results = cross_validate(
                 ^^^^^^^^^^^^^^^
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/utils/_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/model_selection/_validation.py", line 423, in cross_validate
    results = parallel(
              ^^^^^^^^^
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/utils/parallel.py", line 74, in __call__
    return super().__call__(iterable_with_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/joblib/parallel.py", line 2007, in __call__
    return output if self.return_generator else list(output)
                                                ^^^^^^^^^^^^
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/joblib/parallel.py", line 1650, in _get_outputs
    yield from self._retrieve()
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/joblib/parallel.py", line 1754, in _retrieve
    self._raise_error_fast()
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/joblib/parallel.py", line 1789, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/joblib/parallel.py", line 745, in get_result
    return self._return_or_raise()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/joblib/parallel.py", line 763, in _return_or_raise
    raise self._result
joblib.externals.loky.process_executor.TerminatedWorkerError: A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.

The exit codes of the workers are {SIGKILL(-9)}
2025-05-10 05:37:35,828 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:217] - ===== Experiment 8 Cross-Validation Summary (SNLI / full) =====
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:222] -   DecisionTree:
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:223] -     Avg Fit Time: 24.185s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:224] -     Avg Score Time: 0.135s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:225] -     Avg Accuracy: 0.4052 (+/- 0.0008)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:226] -     Avg Precision (Weighted): 0.4044 (+/- 0.0008)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] -     Avg Recall (Weighted): 0.4052 (+/- 0.0008)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:228] -     Avg F1 (Weighted): 0.4047 (+/- 0.0008)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:222] -   KNN:
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:223] -     Avg Fit Time: 0.383s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:224] -     Avg Score Time: 206.198s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:225] -     Avg Accuracy: 0.3750 (+/- 0.0012)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:226] -     Avg Precision (Weighted): 0.3690 (+/- 0.0012)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] -     Avg Recall (Weighted): 0.3750 (+/- 0.0012)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:228] -     Avg F1 (Weighted): 0.3635 (+/- 0.0012)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:222] -   LogisticRegression:
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:223] -     Avg Fit Time: 393.938s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:224] -     Avg Score Time: 0.239s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:225] -     Avg Accuracy: 0.4981 (+/- 0.0021)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:226] -     Avg Precision (Weighted): 0.4975 (+/- 0.0022)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] -     Avg Recall (Weighted): 0.4981 (+/- 0.0021)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:228] -     Avg F1 (Weighted): 0.4935 (+/- 0.0021)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:222] -   MultinomialNB:
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:223] -     Avg Fit Time: 1.697s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:224] -     Avg Score Time: 0.226s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:225] -     Avg Accuracy: 0.4366 (+/- 0.0009)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:226] -     Avg Precision (Weighted): 0.4412 (+/- 0.0012)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] -     Avg Recall (Weighted): 0.4366 (+/- 0.0009)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:228] -     Avg F1 (Weighted): 0.4355 (+/- 0.0009)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:222] -   RandomForest:
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:223] -     Avg Fit Time: 56.061s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:224] -     Avg Score Time: 1.807s
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:225] -     Avg Accuracy: 0.4741 (+/- 0.0018)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:226] -     Avg Precision (Weighted): 0.4711 (+/- 0.0018)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] -     Avg Recall (Weighted): 0.4741 (+/- 0.0018)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:228] -     Avg F1 (Weighted): 0.4721 (+/- 0.0018)
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:220] -   GradientBoosting: ERROR (A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.

The exit codes of the workers are {SIGKILL(-9)})
2025-05-10 05:37:35,829 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:229] - =================================================================
2025-05-10 05:37:35,829 - __main__ - INFO - [main.py:113] - Experiment 8 Results: {'DecisionTree': {'fit_time_mean': 24.184928703308106, 'score_time_mean': 0.13478431701660157, 'total_cv_time': 26.345298767089844, 'accuracy_mean': 0.40524276380346647, 'accuracy_std': 0.0007928316026366236, 'precision_mean': 0.4043943607982715, 'precision_std': 0.0008042425145989668, 'recall_mean': 0.40524276380346647, 'recall_std': 0.0007928316026366236, 'f1_mean': 0.4046955735866978, 'f1_std': 0.0007889885871246944, 'fold_f1_scores': [0.4039115433103007, 0.4041717564987654, 0.40412068179150157, 0.40588247645295994, 0.40539140987996125]}, 'KNN': {'fit_time_mean': 0.3825399398803711, 'score_time_mean': 206.19840970039368, 'total_cv_time': 221.9864616394043, 'accuracy_mean': 0.37500068246546225, 'accuracy_std': 0.0011742744288148574, 'precision_mean': 0.3690080647732925, 'precision_std': 0.0011644825179583302, 'recall_mean': 0.37500068246546225, 'recall_std': 0.0011742744288148574, 'f1_mean': 0.363469499562611, 'f1_std': 0.001166598485331472, 'fold_f1_scores': [0.3624408392768064, 0.3648003163545825, 0.3648631340685017, 0.36316725692160057, 0.3620759511915634]}, 'LogisticRegression': {'fit_time_mean': 393.93789806365965, 'score_time_mean': 0.23932237625122071, 'total_cv_time': 441.97683930397034, 'accuracy_mean': 0.49809326549506555, 'accuracy_std': 0.0020669374174836735, 'precision_mean': 0.4974774406722057, 'precision_std': 0.0021682525427659596, 'recall_mean': 0.49809326549506555, 'recall_std': 0.0020669374174836735, 'f1_mean': 0.4935078476731725, 'f1_std': 0.0021079275813509794, 'fold_f1_scores': [0.48937301136577527, 0.49466323325040845, 0.4949662183045699, 0.49476904683217665, 0.4937677286129325]}, 'MultinomialNB': {'fit_time_mean': 1.6971807479858398, 'score_time_mean': 0.2260425090789795, 'total_cv_time': 2.8049392700195312, 'accuracy_mean': 0.4365806482211953, 'accuracy_std': 0.0008808876507603126, 'precision_mean': 0.44122943906744594, 'precision_std': 0.0011692302059882953, 'recall_mean': 0.4365806482211953, 'recall_std': 0.0008808876507603126, 'f1_mean': 0.43550780629933505, 'f1_std': 0.0009321588347308867, 'fold_f1_scores': [0.433797314814666, 0.4363406158619033, 0.4352625216220414, 0.43620073543314447, 0.43593784376492006]}, 'RandomForest': {'fit_time_mean': 56.06092486381531, 'score_time_mean': 1.8068367958068847, 'total_cv_time': 62.64552712440491, 'accuracy_mean': 0.4740910974078612, 'accuracy_std': 0.0017849122679154004, 'precision_mean': 0.47114995511607277, 'precision_std': 0.0017773642764268125, 'recall_mean': 0.4740910974078612, 'recall_std': 0.0017849122679154004, 'f1_mean': 0.4721239195847561, 'f1_std': 0.0017750540114345168, 'fold_f1_scores': [0.4690253536026184, 0.47136706298620756, 0.4735273691207927, 0.47389962610629655, 0.47280018610786567]}, 'GradientBoosting': {'error': 'A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.\n\nThe exit codes of the workers are {SIGKILL(-9)}'}}
Python script finished with exit code 0 for Task ID 
------------------------------------------------
Job Task  finished.
Total Runtime: 16237 seconds
------------------------------------------------
slurmstepd: error: Detected 1 oom_kill event in StepId=2154744.batch. Some of the step tasks have been OOM Killed.
