/var/spool/slurmd/job2174527/slurm_script: line 45: [: : integer expression expected
/var/spool/slurmd/job2174527/slurm_script: line 45: [: : integer expression expected
------------------------------------------------
SLURM Job ID: 2174527
SLURM Array Job ID: 
SLURM Array Task ID:  / 33
Running on host: ccc0388.campuscluster.illinois.edu
Node allocated: ccc0388
Requested CPUs: 16
Running Dataset: SNLI
Running Experiment (Model Type): experiment-8
Sample Size: 10000 (8000 train, 1000 validation, 1000 test)
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated: /sw/apps/anaconda3/2024.10/bin/python
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for SNLI / experiment-8 (Task ID )...
2025-05-11 21:53:12,993 - datasets - INFO - [config.py:54] - PyTorch version 2.6.0+cu126 available.
2025-05-11 21:53:30,694 - __main__ - INFO - [main.py:47] - Running mode: train
2025-05-11 21:53:30,694 - __main__ - INFO - [main.py:48] - Selected model type: experiment-8
2025-05-11 21:53:30,715 - __main__ - INFO - [main.py:49] - Selected dataset: SNLI
2025-05-11 21:53:30,716 - __main__ - INFO - [main.py:50] - Using device: cuda
2025-05-11 21:53:30,716 - __main__ - INFO - [main.py:52] - Using sample size: 10000
2025-05-11 21:53:30,716 - __main__ - INFO - [main.py:92] - Starting training for model: experiment-8
2025-05-11 21:53:30,717 - utils.common - INFO - [common.py:184] - Calculated split sizes for total 10000: train=8000, val=1000, test=1000
2025-05-11 21:53:30,717 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:52] - Experiment 8 (using get_split_sizes): total_sample_size from args = 10000, calculated train samples for suffix = 8000. Expected suffix: 'sample8000'
2025-05-11 21:53:30,720 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:179] - ===== Starting Experiment 8: Syntactic Feature Cross-Validation =====
2025-05-11 21:53:30,720 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:180] - Dataset: SNLI, Suffix used for loading: sample8000, Folds: 5
2025-05-11 21:53:30,720 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:132] - Exp8: Loading precomputed features for SNLI/train/sample8000
2025-05-11 21:53:30,725 - utils.database - INFO - [database.py:80] - Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/train/SNLI_train_features_stats_syntactic_sample8000.parquet
2025-05-11 21:53:30,988 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:165] - Exp8: Using 229 syntactic features for cross-validation.
2025-05-11 21:53:30,992 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:197] - --- Running Cross-Validation for: DecisionTree ---
2025-05-11 21:53:42,982 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] - Finished CV for DecisionTree in 11.79s. Avg F1: 0.3905
2025-05-11 21:53:42,983 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:197] - --- Running Cross-Validation for: KNN ---
2025-05-11 21:53:51,074 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] - Finished CV for KNN in 8.09s. Avg F1: 0.3841
2025-05-11 21:53:51,075 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:197] - --- Running Cross-Validation for: LogisticRegression ---
/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1271: UserWarning: 'n_jobs' > 1 does not have any effect when 'solver' is set to 'liblinear'. Got 'n_jobs' = 16.
  warnings.warn(
/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1271: UserWarning: 'n_jobs' > 1 does not have any effect when 'solver' is set to 'liblinear'. Got 'n_jobs' = 16.
  warnings.warn(
/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1271: UserWarning: 'n_jobs' > 1 does not have any effect when 'solver' is set to 'liblinear'. Got 'n_jobs' = 16.
  warnings.warn(
/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1271: UserWarning: 'n_jobs' > 1 does not have any effect when 'solver' is set to 'liblinear'. Got 'n_jobs' = 16.
  warnings.warn(
/sw/apps/anaconda3/2024.10/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py:1271: UserWarning: 'n_jobs' > 1 does not have any effect when 'solver' is set to 'liblinear'. Got 'n_jobs' = 16.
  warnings.warn(
2025-05-11 21:53:58,141 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] - Finished CV for LogisticRegression in 7.07s. Avg F1: 0.4752
2025-05-11 21:53:58,141 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:197] - --- Running Cross-Validation for: MultinomialNB ---
2025-05-11 21:54:02,471 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] - Finished CV for MultinomialNB in 4.33s. Avg F1: 0.4308
2025-05-11 21:54:02,471 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:197] - --- Running Cross-Validation for: RandomForest ---
2025-05-11 21:54:03,504 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] - Finished CV for RandomForest in 1.03s. Avg F1: 0.4738
2025-05-11 21:54:03,504 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:197] - --- Running Cross-Validation for: GradientBoosting ---
2025-05-11 21:59:03,998 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:227] - Finished CV for GradientBoosting in 300.49s. Avg F1: 0.3527
2025-05-11 21:59:03,999 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:235] - ===== Experiment 8 Cross-Validation Summary (SNLI / sample8000) =====
2025-05-11 21:59:04,088 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:240] -   DecisionTree:
2025-05-11 21:59:04,088 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:241] -     Avg Fit Time: 0.200s
2025-05-11 21:59:04,088 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:242] -     Avg Score Time: 0.008s
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:243] -     Avg Accuracy: 0.3908 (+/- 0.0120)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:244] -     Avg Precision (Weighted): 0.3909 (+/- 0.0115)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:245] -     Avg Recall (Weighted): 0.3908 (+/- 0.0120)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:246] -     Avg F1 (Weighted): 0.3905 (+/- 0.0116)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:240] -   KNN:
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:241] -     Avg Fit Time: 0.008s
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:242] -     Avg Score Time: 1.884s
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:243] -     Avg Accuracy: 0.3924 (+/- 0.0092)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:244] -     Avg Precision (Weighted): 0.3925 (+/- 0.0098)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:245] -     Avg Recall (Weighted): 0.3924 (+/- 0.0092)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:246] -     Avg F1 (Weighted): 0.3841 (+/- 0.0104)
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:240] -   LogisticRegression:
2025-05-11 21:59:04,097 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:241] -     Avg Fit Time: 0.818s
2025-05-11 21:59:04,102 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:242] -     Avg Score Time: 0.052s
2025-05-11 21:59:04,102 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:243] -     Avg Accuracy: 0.4780 (+/- 0.0067)
2025-05-11 21:59:04,102 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:244] -     Avg Precision (Weighted): 0.4788 (+/- 0.0079)
2025-05-11 21:59:04,102 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:245] -     Avg Recall (Weighted): 0.4780 (+/- 0.0067)
2025-05-11 21:59:04,102 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:246] -     Avg F1 (Weighted): 0.4752 (+/- 0.0073)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:240] -   MultinomialNB:
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:241] -     Avg Fit Time: 0.052s
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:242] -     Avg Score Time: 0.006s
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:243] -     Avg Accuracy: 0.4306 (+/- 0.0096)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:244] -     Avg Precision (Weighted): 0.4354 (+/- 0.0102)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:245] -     Avg Recall (Weighted): 0.4306 (+/- 0.0096)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:246] -     Avg F1 (Weighted): 0.4308 (+/- 0.0095)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:240] -   RandomForest:
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:241] -     Avg Fit Time: 0.496s
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:242] -     Avg Score Time: 0.047s
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:243] -     Avg Accuracy: 0.4760 (+/- 0.0068)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:244] -     Avg Precision (Weighted): 0.4733 (+/- 0.0073)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:245] -     Avg Recall (Weighted): 0.4760 (+/- 0.0068)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:246] -     Avg F1 (Weighted): 0.4738 (+/- 0.0074)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:240] -   GradientBoosting:
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:241] -     Avg Fit Time: 59.961s
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:242] -     Avg Score Time: 0.132s
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:243] -     Avg Accuracy: 0.4089 (+/- 0.0129)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:244] -     Avg Precision (Weighted): 0.4859 (+/- 0.0139)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:245] -     Avg Recall (Weighted): 0.4089 (+/- 0.0129)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:246] -     Avg F1 (Weighted): 0.3527 (+/- 0.0165)
2025-05-11 21:59:04,105 - models.cross_validate_syntactic_experiment_8 - INFO - [cross_validate_syntactic_experiment_8.py:247] - =================================================================
2025-05-11 21:59:04,105 - __main__ - INFO - [main.py:113] - Experiment 8 Results: {'DecisionTree': {'fit_time_mean': 0.19972577095031738, 'score_time_mean': 0.0076084136962890625, 'total_cv_time': 11.794499635696411, 'accuracy_mean': 0.39075000000000004, 'accuracy_std': 0.012037701192503495, 'precision_mean': 0.39085988635520297, 'precision_std': 0.011541168627678755, 'recall_mean': 0.39075000000000004, 'recall_std': 0.012037701192503495, 'f1_mean': 0.39054152086940863, 'f1_std': 0.011642723593620459, 'fold_f1_scores': [0.3719554421618762, 0.4022213354232768, 0.3933360889455239, 0.40207476413584947, 0.383119973680517]}, 'KNN': {'fit_time_mean': 0.007917451858520507, 'score_time_mean': 1.884448528289795, 'total_cv_time': 8.09141993522644, 'accuracy_mean': 0.39237500000000003, 'accuracy_std': 0.009248310656546953, 'precision_mean': 0.39246614192391477, 'precision_std': 0.009835260778798425, 'recall_mean': 0.39237500000000003, 'recall_std': 0.009248310656546953, 'f1_mean': 0.38413246284090574, 'f1_std': 0.010353489633256677, 'fold_f1_scores': [0.3907647447788157, 0.3847158954823836, 0.385716822517058, 0.3647255051172277, 0.3947393463090435]}, 'LogisticRegression': {'fit_time_mean': 0.8183874607086181, 'score_time_mean': 0.05151820182800293, 'total_cv_time': 7.06594705581665, 'accuracy_mean': 0.47800000000000004, 'accuracy_std': 0.006689544080129822, 'precision_mean': 0.47884444886483724, 'precision_std': 0.007919766884347352, 'recall_mean': 0.47800000000000004, 'recall_std': 0.006689544080129822, 'f1_mean': 0.4752273530608817, 'f1_std': 0.007278361241390656, 'fold_f1_scores': [0.4729233528893373, 0.4755262718896319, 0.4889684923079915, 0.46841367428742514, 0.47030497393002263]}, 'MultinomialNB': {'fit_time_mean': 0.05200982093811035, 'score_time_mean': 0.006492137908935547, 'total_cv_time': 4.32975697517395, 'accuracy_mean': 0.4306249999999999, 'accuracy_std': 0.009560661587986465, 'precision_mean': 0.43541387755709665, 'precision_std': 0.010226555674928325, 'recall_mean': 0.4306249999999999, 'recall_std': 0.009560661587986465, 'f1_mean': 0.43084967631517845, 'f1_std': 0.00948563546036761, 'fold_f1_scores': [0.4262249313211719, 0.4217809840425666, 0.44394415436077345, 0.4218053819751066, 0.44049292987627353]}, 'RandomForest': {'fit_time_mean': 0.4963692665100098, 'score_time_mean': 0.04681844711303711, 'total_cv_time': 1.0325689315795898, 'accuracy_mean': 0.476, 'accuracy_std': 0.006819090848492933, 'precision_mean': 0.47330463777003856, 'precision_std': 0.007341847267577909, 'recall_mean': 0.476, 'recall_std': 0.006819090848492933, 'f1_mean': 0.47384621938732047, 'f1_std': 0.007361936183438458, 'fold_f1_scores': [0.4718731290357458, 0.480213537190929, 0.47863680653785434, 0.46026981059981553, 0.47823781357225753]}, 'GradientBoosting': {'fit_time_mean': 59.96094217300415, 'score_time_mean': 0.13150010108947754, 'total_cv_time': 300.4939007759094, 'accuracy_mean': 0.408875, 'accuracy_std': 0.012902276930836665, 'precision_mean': 0.4858794976177048, 'precision_std': 0.013850386537471653, 'recall_mean': 0.408875, 'recall_std': 0.012902276930836665, 'f1_mean': 0.3526569939015567, 'f1_std': 0.01651084429724619, 'fold_f1_scores': [0.3667057159811584, 0.3763518608201295, 0.34475653340492074, 0.3307890942413001, 0.3446817650602748]}}
Python script finished with exit code 0 for Task ID 
------------------------------------------------
Job Task  finished.
Total Runtime: 385 seconds
------------------------------------------------
