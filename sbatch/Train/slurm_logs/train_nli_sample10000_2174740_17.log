------------------------------------------------
Initial SLURM_ARRAY_TASK_ID: '17'
Validated SLURM_ARRAY_TASK_ID: 17
------------------------------------------------
DEBUG: NUM_DATASETS=3, NUM_EXPERIMENTS=9, TOTAL_TASKS=27
------------------------------------------------
SLURM Job ID: 2175001
SLURM Array Job ID: 2174740
SLURM Array Task ID: 17 / 27
Running on host: ccc0366.campuscluster.illinois.edu
Node allocated: ccc0366
Requested CPUs: 16
Running Dataset: MNLI
Running Experiment (Model Type): experiment-5
Sample Size: 10000 (8000 train, 1000 validation, 1000 test)
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated: /sw/apps/anaconda3/2024.10/bin/python
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for MNLI / experiment-5 (Task ID 17)...
2025-05-11 22:43:14,106 - datasets - INFO - [config.py:54] - PyTorch version 2.6.0+cu126 available.
2025-05-11 22:43:16,623 - __main__ - INFO - [main.py:47] - Running mode: train
2025-05-11 22:43:16,623 - __main__ - INFO - [main.py:48] - Selected model type: experiment-5
2025-05-11 22:43:16,623 - __main__ - INFO - [main.py:49] - Selected dataset: MNLI
2025-05-11 22:43:16,623 - __main__ - INFO - [main.py:50] - Using device: cpu
2025-05-11 22:43:16,623 - __main__ - INFO - [main.py:52] - Using sample size: 10000
2025-05-11 22:43:16,623 - __main__ - INFO - [main.py:92] - Starting training for model: experiment-5
2025-05-11 22:43:16,630 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:55] - Initialized ExperimentTrainer for model key: 'experiment-5', class: RandomForestBowSyntacticExperiment5, dataset: MNLI, suffix: sample10000
2025-05-11 22:43:16,631 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:71] - Initializing model instance for experiment-5 (RandomForestBowSyntacticExperiment5)
2025-05-11 22:43:16,631 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:76] - Initialized RandomForest_BoW_Syntactic_Exp5_PipelineCompatible with params: {'bow_max_features': 5000, 'bow_ngram_range': (1, 1), 'n_estimators': 100, 'max_depth': None, 'random_state': 42, 'min_samples_split': 2, 'min_samples_leaf': 1, 'scale_syntactic': True}
2025-05-11 22:43:16,631 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:93] - Model experiment-5 initialized successfully.
2025-05-11 22:43:16,631 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:107] - --- Loading Pre-computed Features for experiment-5 on MNLI (train/sample10000) ---
2025-05-11 22:43:16,631 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:115] - Loading pre-computed features using SimpleParquetLoader...
2025-05-11 22:43:16,631 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:128] - Attempting to load feature file matching: dataset='MNLI', split='train', suffix='sample10000'
2025-05-11 22:43:16,631 - models.baseline_base - INFO - [baseline_base.py:622] - SimpleParquetLoader: Searching for features in cache/parquet/MNLI/train for MNLI/train/sample10000
2025-05-11 22:43:17,224 - models.baseline_base - INFO - [baseline_base.py:685] - SimpleParquetLoader: Loading final features from: cache/parquet/MNLI/train/MNLI_train_features_stats_syntactic_full.parquet
2025-05-11 22:43:17,663 - models.baseline_base - INFO - [baseline_base.py:687] - SimpleParquetLoader: Loaded 392702 rows from cache/parquet/MNLI/train/MNLI_train_features_stats_syntactic_full.parquet
2025-05-11 22:43:17,663 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:153] - Loaded 392702 rows with 255 columns from pre-computed feature file.
2025-05-11 22:43:17,666 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:163] - Feature data cleaned. 392702 samples remaining.
2025-05-11 22:43:17,666 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:172] - Extracting/Selecting features using experiment-5.extract_features...
2025-05-11 22:43:17,666 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:193] - RandomForest_BoW_Syntactic_Exp5_PipelineCompatible: Fitting feature pipeline and transforming training data...
2025-05-11 22:43:26,885 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:202] - Feature pipeline fit and transform complete in 9.22s. Output shape: (392702, 5245)
2025-05-11 22:43:26,885 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:182] - Training features prepared. Shape: (392702, 5245)
2025-05-11 22:43:26,885 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:183] - Training labels prepared. Length: 392702
2025-05-11 22:43:27,001 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:194] - Data loading and preparation phase finished in 10.37s
2025-05-11 22:43:27,001 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:198] - --- Starting model training for experiment-5 on MNLI (sample10000) ---
2025-05-11 22:43:27,001 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:246] - Training RandomForest_BoW_Syntactic_Exp5_PipelineCompatible classifier on 392702 samples, 5245 features...
2025-05-11 22:52:57,915 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:261] - Classifier training complete in 570.91s.
2025-05-11 22:52:57,916 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:217] - Model training phase for experiment-5 finished in 570.92s
2025-05-11 22:52:58,051 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:226] - Saving model experiment-5...
2025-05-11 22:52:58,052 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:322] - Saving RandomForest_BoW_Syntactic_Exp5_PipelineCompatible feature pipeline to /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/experiment-5/sample10000/MNLI_experiment-5_sample10000_feature_pipeline.joblib
2025-05-11 22:52:58,052 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:323] - Saving RandomForest_BoW_Syntactic_Exp5_PipelineCompatible classifier to /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/experiment-5/sample10000/MNLI_experiment-5_sample10000_classifier.joblib
2025-05-11 22:52:58,052 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:324] - Saving RandomForest_BoW_Syntactic_Exp5_PipelineCompatible metadata to /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/experiment-5/sample10000/MNLI_experiment-5_sample10000_metadata.joblib
2025-05-11 22:53:14,606 - models.random_forest_bow_syntactic_experiment_5 - INFO - [random_forest_bow_syntactic_experiment_5.py:330] - RandomForest_BoW_Syntactic_Exp5_PipelineCompatible components saved successfully.
2025-05-11 22:53:14,607 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:231] - Model experiment-5 saved in directory: /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/experiment-5/sample10000 with base name: MNLI_experiment-5_sample10000
2025-05-11 22:53:14,648 - __main__ - INFO - [main.py:123] - Training completed. Results: {'experiment-5': {'status': 'trained', 'train_time': 570.9153690338135}}
Python script finished with exit code 0 for Task ID 17
------------------------------------------------
Job Task 17 finished.
Total Runtime: 606 seconds
------------------------------------------------
