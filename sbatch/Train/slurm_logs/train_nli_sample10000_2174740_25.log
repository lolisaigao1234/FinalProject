------------------------------------------------
Initial SLURM_ARRAY_TASK_ID: '25'
Validated SLURM_ARRAY_TASK_ID: 25
------------------------------------------------
DEBUG: NUM_DATASETS=3, NUM_EXPERIMENTS=9, TOTAL_TASKS=27
------------------------------------------------
SLURM Job ID: 2175318
SLURM Array Job ID: 2174740
SLURM Array Task ID: 25 / 27
Running on host: ccc0290.campuscluster.illinois.edu
Node allocated: ccc0290
Requested CPUs: 16
Running Dataset: ANLI
Running Experiment (Model Type): experiment-4
Sample Size: 10000 (8000 train, 1000 validation, 1000 test)
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated: /sw/apps/anaconda3/2024.10/bin/python
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for ANLI / experiment-4 (Task ID 25)...
2025-05-11 22:46:48,906 - datasets - INFO - [config.py:54] - PyTorch version 2.6.0+cu126 available.
2025-05-11 22:46:51,245 - __main__ - INFO - [main.py:47] - Running mode: train
2025-05-11 22:46:51,245 - __main__ - INFO - [main.py:48] - Selected model type: experiment-4
2025-05-11 22:46:51,245 - __main__ - INFO - [main.py:49] - Selected dataset: ANLI
2025-05-11 22:46:51,245 - __main__ - INFO - [main.py:50] - Using device: cpu
2025-05-11 22:46:51,245 - __main__ - INFO - [main.py:52] - Using sample size: 10000
2025-05-11 22:46:51,245 - __main__ - INFO - [main.py:92] - Starting training for model: experiment-4
2025-05-11 22:46:52,000 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:55] - Initialized ExperimentTrainer for model key: 'experiment-4', class: MultinomialNaiveBayesBowSyntacticExperiment4, dataset: ANLI, suffix: sample10000
2025-05-11 22:46:52,000 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:71] - Initializing model instance for experiment-4 (MultinomialNaiveBayesBowSyntacticExperiment4)
2025-05-11 22:46:52,000 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:145] - Initialized MultinomialNaiveBayesBowSyntacticExperiment4 with: alpha=1.0, bow_max_features=10000, bow_ngram_range=(1, 1), scale_syntactic=True
2025-05-11 22:46:52,000 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:93] - Model experiment-4 initialized successfully.
2025-05-11 22:46:52,000 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:107] - --- Loading Pre-computed Features for experiment-4 on ANLI (train/sample10000) ---
2025-05-11 22:46:52,000 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:115] - Loading pre-computed features using SimpleParquetLoader...
2025-05-11 22:46:52,000 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:128] - Attempting to load feature file matching: dataset='ANLI', split='train', suffix='sample10000'
2025-05-11 22:46:52,000 - models.baseline_base - INFO - [baseline_base.py:622] - SimpleParquetLoader: Searching for features in cache/parquet/ANLI/train for ANLI/train/sample10000
2025-05-11 22:46:52,421 - models.baseline_base - INFO - [baseline_base.py:685] - SimpleParquetLoader: Loading final features from: cache/parquet/ANLI/train/ANLI_train_features_stats_syntactic_full.parquet
2025-05-11 22:46:52,803 - models.baseline_base - INFO - [baseline_base.py:687] - SimpleParquetLoader: Loaded 740653 rows from cache/parquet/ANLI/train/ANLI_train_features_stats_syntactic_full.parquet
2025-05-11 22:46:52,803 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:153] - Loaded 740653 rows with 253 columns from pre-computed feature file.
2025-05-11 22:46:52,807 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:163] - Feature data cleaned. 740653 samples remaining.
2025-05-11 22:46:52,807 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:172] - Extracting/Selecting features using experiment-4.extract_features...
2025-05-11 22:46:52,807 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:423] - Model not trained yet. Assuming training context: Building/Fitting pipeline...
2025-05-11 22:46:52,807 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:288] - Exp4: Building feature pipeline...
2025-05-11 22:46:52,807 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:293] - Using max_features per text part (premise/hypothesis): 5000
2025-05-11 22:46:52,807 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - WARNING - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:311] - Re-inferring syntactic columns during pipeline build.
2025-05-11 22:46:52,807 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:327] - Adding MinMaxScaler for syntactic features.
2025-05-11 22:46:52,808 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:344] - Including BoW features in FeatureUnion.
2025-05-11 22:46:52,808 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:351] - Including 243 syntactic features in FeatureUnion.
2025-05-11 22:46:52,808 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:363] - Exp4: Feature pipeline built.
2025-05-11 22:46:52,808 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:429] - Fitting feature pipeline and transforming training data...
2025-05-11 22:47:17,476 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:440] - Pipeline fit & transform completed in 24.67s. Output shape: (740653, 10243)
2025-05-11 22:47:17,477 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:182] - Training features prepared. Shape: (740653, 10243)
2025-05-11 22:47:17,477 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:183] - Training labels prepared. Length: 740653
2025-05-11 22:47:17,602 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:194] - Data loading and preparation phase finished in 25.60s
2025-05-11 22:47:17,602 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:198] - --- Starting model training for experiment-4 on ANLI (sample10000) ---
2025-05-11 22:47:17,623 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:393] - Training MultinomialNB classifier on processed data with shape: (740653, 10243)
2025-05-11 22:47:17,881 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:398] - MultinomialNB classifier training completed successfully.
2025-05-11 22:47:17,881 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:405] - Classifier training phase completed in 0.26s.
2025-05-11 22:47:17,881 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:217] - Model training phase for experiment-4 finished in 0.28s
2025-05-11 22:47:17,970 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:226] - Saving model experiment-4...
2025-05-11 22:47:17,970 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:495] - Saving Exp4 model to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-4/sample10000/ANLI_experiment-4_sample10000_model.joblib
2025-05-11 22:47:17,970 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:496] - Saving Exp4 pipeline to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-4/sample10000/ANLI_experiment-4_sample10000_pipeline.joblib
2025-05-11 22:47:17,970 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:497] - Saving Exp4 metadata to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-4/sample10000/ANLI_experiment-4_sample10000_metadata.joblib
2025-05-11 22:47:19,610 - models.multinomial_naive_bayes_bow_syntactic_experiment_4 - INFO - [multinomial_naive_bayes_bow_syntactic_experiment_4.py:513] - Exp4 Model, Pipeline, and Metadata saved successfully.
2025-05-11 22:47:19,610 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:231] - Model experiment-4 saved in directory: /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-4/sample10000 with base name: ANLI_experiment-4_sample10000
2025-05-11 22:47:19,626 - __main__ - INFO - [main.py:123] - Training completed. Results: {'experiment-4': {'status': 'trained', 'train_time': 0.2791025638580322}}
Python script finished with exit code 0 for Task ID 25
------------------------------------------------
Job Task 25 finished.
Total Runtime: 37 seconds
------------------------------------------------
