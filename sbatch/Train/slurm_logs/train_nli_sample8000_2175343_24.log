------------------------------------------------
Initial SLURM_ARRAY_TASK_ID: '24'
Validated SLURM_ARRAY_TASK_ID: 24
------------------------------------------------
DEBUG: NUM_DATASETS=3, NUM_EXPERIMENTS=9, TOTAL_TASKS=27
------------------------------------------------
SLURM Job ID: 2175381
SLURM Array Job ID: 2175343
SLURM Array Task ID: 24 / 27
Running on host: ccc0359.campuscluster.illinois.edu
Node allocated: ccc0359
Requested CPUs: 16
Running Dataset: ANLI
Running Experiment (Model Type): experiment-3
Sample Size: 10000 (8000 train, 1000 validation, 1000 test)
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated: /sw/apps/anaconda3/2024.10/bin/python
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for ANLI / experiment-3 (Task ID 24)...
2025-05-11 22:56:50,561 - datasets - INFO - [config.py:54] - PyTorch version 2.6.0+cu126 available.
2025-05-11 22:56:54,740 - __main__ - INFO - [main.py:47] - Running mode: train
2025-05-11 22:56:54,740 - __main__ - INFO - [main.py:48] - Selected model type: experiment-3
2025-05-11 22:56:54,740 - __main__ - INFO - [main.py:49] - Selected dataset: ANLI
2025-05-11 22:56:54,740 - __main__ - INFO - [main.py:50] - Using device: cpu
2025-05-11 22:56:54,740 - __main__ - INFO - [main.py:52] - Using sample size: 8000
2025-05-11 22:56:54,740 - __main__ - INFO - [main.py:92] - Starting training for model: experiment-3
2025-05-11 22:56:54,959 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:55] - Initialized ExperimentTrainer for model key: 'experiment-3', class: LogisticTFIDFSyntacticExperiment3, dataset: ANLI, suffix: sample8000
2025-05-11 22:56:54,959 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:71] - Initializing model instance for experiment-3 (LogisticTFIDFSyntacticExperiment3)
2025-05-11 22:56:54,959 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:93] - Model experiment-3 initialized successfully.
2025-05-11 22:56:54,959 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:107] - --- Loading Pre-computed Features for experiment-3 on ANLI (train/sample8000) ---
2025-05-11 22:56:54,959 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:115] - Loading pre-computed features using SimpleParquetLoader...
2025-05-11 22:56:54,959 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:128] - Attempting to load feature file matching: dataset='ANLI', split='train', suffix='sample8000'
2025-05-11 22:56:54,959 - models.baseline_base - INFO - [baseline_base.py:622] - SimpleParquetLoader: Searching for features in cache/parquet/ANLI/train for ANLI/train/sample8000
2025-05-11 22:56:54,998 - models.baseline_base - INFO - [baseline_base.py:685] - SimpleParquetLoader: Loading final features from: cache/parquet/ANLI/train/ANLI_train_features_stats_syntactic_sample8000.parquet
2025-05-11 22:56:55,026 - models.baseline_base - INFO - [baseline_base.py:687] - SimpleParquetLoader: Loaded 9200 rows from cache/parquet/ANLI/train/ANLI_train_features_stats_syntactic_sample8000.parquet
2025-05-11 22:56:55,026 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:153] - Loaded 9200 rows with 252 columns from pre-computed feature file.
2025-05-11 22:56:55,027 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:163] - Feature data cleaned. 9200 samples remaining.
2025-05-11 22:56:55,027 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:172] - Extracting/Selecting features using experiment-3.extract_features...
2025-05-11 22:56:55,027 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:235] - Model not trained yet. Assuming training context: Building/Fitting pipeline...
2025-05-11 22:56:55,027 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:151] - Building feature pipeline for Exp3...
2025-05-11 22:56:55,027 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:174] - Identified 242 syntactic feature columns for pipeline.
2025-05-11 22:56:55,027 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:209] - Feature pipeline built.
2025-05-11 22:56:55,027 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:245] - Fitting feature pipeline and transforming training data...
2025-05-11 22:56:55,802 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:78] - FeatureSelector fit: All 242 potential columns were found in the training data.
2025-05-11 22:56:55,880 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:251] - Pipeline fit during training context successful.
2025-05-11 22:56:55,880 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:260] - Pipeline fit & transform completed in 0.85s. Output shape: (9200, 10242)
2025-05-11 22:56:55,880 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:182] - Training features prepared. Shape: (9200, 10242)
2025-05-11 22:56:55,880 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:183] - Training labels prepared. Length: 9200
2025-05-11 22:56:55,979 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:194] - Data loading and preparation phase finished in 1.02s
2025-05-11 22:56:55,979 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:198] - --- Starting model training for experiment-3 on ANLI (sample8000) ---
2025-05-11 22:56:55,979 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:319] - Training Logistic Regression classifier on processed data with shape: (9200, 10242)
2025-05-11 22:57:02,266 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:326] - Logistic Regression classifier training completed successfully.
2025-05-11 22:57:02,267 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:333] - Classifier training phase completed in 6.29s.
2025-05-11 22:57:02,267 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:217] - Model training phase for experiment-3 finished in 6.29s
2025-05-11 22:57:02,401 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:226] - Saving model experiment-3...
2025-05-11 22:57:02,401 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:477] - Saving Exp3 model to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-3/sample8000/ANLI_experiment-3_sample8000_model.joblib
2025-05-11 22:57:02,401 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:478] - Saving Exp3 pipeline to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-3/sample8000/ANLI_experiment-3_sample8000_pipeline.joblib
2025-05-11 22:57:02,401 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:479] - Saving Exp3 metadata to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-3/sample8000/ANLI_experiment-3_sample8000_metadata.joblib
2025-05-11 22:57:03,187 - models.logistic_tfidf_syntactic_experiment_3 - INFO - [logistic_tfidf_syntactic_experiment_3.py:496] - Exp3 Model, Pipeline, and Metadata saved successfully.
2025-05-11 22:57:03,187 - models.base_experiment_trainer - INFO - [base_experiment_trainer.py:231] - Model experiment-3 saved in directory: /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/experiment-3/sample8000 with base name: ANLI_experiment-3_sample8000
2025-05-11 22:57:03,189 - __main__ - INFO - [main.py:123] - Training completed. Results: {'experiment-3': {'status': 'trained', 'train_time': 6.288135051727295}}
Python script finished with exit code 0 for Task ID 24
------------------------------------------------
Job Task 24 finished.
Total Runtime: 18 seconds
------------------------------------------------
