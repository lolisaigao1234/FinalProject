------------------------------------------------
SLURM Job ID: 2003163
SLURM Array Job ID: 2003051
SLURM Array Task ID: 14
Running on host: ccc0361.campuscluster.illinois.edu
Node allocated: ccc0361
Requested CPUs: 16
Requested Memory: M
Running Dataset: MNLI
Running Experiment: mnb_bow
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated.
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for MNLI / mnb_bow (Task ID 14)...
INFO:__main__:Running in train mode on MNLI dataset
INFO:__main__:Using device: cpu
INFO:__main__:Selected model type: mnb_bow
INFO:__main__:Using sample size: 100
INFO:__main__:Initializing BaselineTrainer for model: mnb_bow, dataset: MNLI
INFO:__main__:Starting training process...
INFO:models.baseline_trainer:Trainer loading data for mnb_bow on MNLI (sample100)
INFO:models.baseline_trainer:Loading raw text data for mnb_bow
INFO:models.baseline_base:Attempting to load intermediate raw text data: MNLI/train/sample100
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/pairs_sample100.parquet or final path for table 'pairs_sample100'.
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/sentences_sample100.parquet or final path for table 'sentences_sample100'.
WARNING:models.baseline_base:Intermediate data (pairs_sample100 or sentences_sample100) not found or empty. Falling back to original data loader.
WARNING:models.baseline_base:Executing fallback: Loading original raw data using DatasetLoader.
INFO:data.data_loader:Loading dataset: MNLI (HF: nyu-mll/multi_nli), Split: train
INFO:data.data_loader:Loading raw MNLI/train from DB table: raw_data_full
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/MNLI/train/raw_data_full.parquet
INFO:data.data_loader:Loaded 392702 examples for MNLI/train
INFO:models.baseline_base:Fallback data loaded successfully. Shape: (392702, 12)
INFO:models.baseline_base:Attempting to load intermediate raw text data: MNLI/validation/sample100
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/MNLI/validation/pairs_sample100.parquet or final path for table 'pairs_sample100'.
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/MNLI/validation/sentences_sample100.parquet or final path for table 'sentences_sample100'.
WARNING:models.baseline_base:Intermediate data (pairs_sample100 or sentences_sample100) not found or empty. Falling back to original data loader.
WARNING:models.baseline_base:Executing fallback: Loading original raw data using DatasetLoader.
INFO:data.data_loader:Loading dataset: MNLI (HF: nyu-mll/multi_nli), Split: validation
INFO:data.data_loader:Loading raw MNLI/validation from DB table: raw_data_full
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/MNLI/validation/raw_data_full.parquet
INFO:data.data_loader:Loaded 9815 examples for MNLI/validation
INFO:models.baseline_base:Fallback data loaded successfully. Shape: (9815, 12)
INFO:models.baseline_base:Attempting to load intermediate raw text data: MNLI/test/sample100
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/MNLI/test/pairs_sample100.parquet or final path for table 'pairs_sample100'.
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/MNLI/test/sentences_sample100.parquet or final path for table 'sentences_sample100'.
WARNING:models.baseline_base:Intermediate data (pairs_sample100 or sentences_sample100) not found or empty. Falling back to original data loader.
WARNING:models.baseline_base:Executing fallback: Loading original raw data using DatasetLoader.
INFO:data.data_loader:Loading dataset: MNLI (HF: nyu-mll/multi_nli), Split: test
INFO:data.data_loader:Loading raw MNLI/test from DB table: raw_data_full
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/MNLI/test/raw_data_full.parquet
INFO:data.data_loader:Loaded 9832 examples for MNLI/test
INFO:models.baseline_base:Fallback data loaded successfully. Shape: (9832, 12)
INFO:models.baseline_trainer:Initializing model: mnb_bow
INFO:models.baseline_trainer:Handling mnb_bow. Using raw text data.
INFO:models.baseline_trainer:Fitting feature extractor...
INFO:models.baseline_base:Fitting CountVectorizer on 392702 combined texts...
INFO:models.baseline_base:CountVectorizer fitted. Vocabulary size: 10000
INFO:models.baseline_trainer:Transforming training data...
INFO:models.baseline_base:Training MultinomialNB with 392702 samples...
INFO:models.baseline_base:MultinomialNB training complete.
INFO:models.baseline_trainer:Evaluating on validation data...
INFO:models.baseline_base:Evaluating model on 9815 samples...
INFO:models.baseline_base:Prediction finished in 0.00 seconds.
INFO:models.baseline_base:Evaluation Metrics - Accuracy: 0.4521, Precision: 0.4531, Recall: 0.4521, F1: 0.4518
INFO:models.baseline_base:MultinomialNB model saved to /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/mnb_bow/sample100/MNLI_mnb_bow_sample100_model.joblib
INFO:models.baseline_base:Feature extractor (BoWExtractor) saved to /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/mnb_bow/sample100/MNLI_mnb_bow_sample100_extractor.joblib
INFO:models.baseline_trainer:Starting evaluation: Model=mnb_bow, Dataset=MNLI, Suffix=sample100
INFO:models.baseline_trainer:Loading mnb_bow model from base path /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/mnb_bow/sample100/MNLI_mnb_bow_sample100 for evaluation...
INFO:models.baseline_base:MultinomialNaiveBayesBaseline loaded from /scratch/jywu3/IS567FP/saved_models/baseline_models/MNLI/mnb_bow/sample100 using base name MNLI_mnb_bow_sample100
INFO:models.baseline_trainer:Extracting features for evaluation...
INFO:models.baseline_base:Evaluating model on 9832 samples...
INFO:models.baseline_base:Prediction finished in 0.00 seconds.
INFO:models.baseline_base:Evaluation Metrics - Accuracy: 0.4415, Precision: 0.4471, Recall: 0.4415, F1: 0.4405
INFO:models.baseline_trainer:Evaluation results for mnb_bow: {'accuracy': 0.44151749389747763, 'precision': 0.4471436019167249, 'recall': 0.44151749389747763, 'f1': 0.4405048229705402}
INFO:__main__:Training finished. Results: {'mnb_bow': {'accuracy': 0.45206316861946, 'precision': 0.45308197990793747, 'recall': 0.45206316861946, 'f1': 0.45178678525959864, 'eval_time': 0.0011250972747802734, 'train_time': 0.04732012748718262}}
Python script finished with exit code 0 for Task ID 14
------------------------------------------------
Job Task 14 finished.
Total Runtime: 32 seconds
------------------------------------------------
