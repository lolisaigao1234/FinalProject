------------------------------------------------
SLURM Job ID: 2003145
SLURM Array Job ID: 2003051
SLURM Array Task ID: 2
Running on host: ccc0361.campuscluster.illinois.edu
Node allocated: ccc0361
Requested CPUs: 16
Requested Memory: M
Running Dataset: SNLI
Running Experiment: logistic_tfidf
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated.
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for SNLI / logistic_tfidf (Task ID 2)...
INFO:__main__:Running in train mode on SNLI dataset
INFO:__main__:Using device: cpu
INFO:__main__:Selected model type: logistic_tfidf
INFO:__main__:Using sample size: 100
INFO:__main__:Initializing BaselineTrainer for model: logistic_tfidf, dataset: SNLI
INFO:__main__:Starting training process...
INFO:models.baseline_trainer:Trainer loading data for logistic_tfidf on SNLI (sample100)
INFO:models.baseline_trainer:Loading raw text data for logistic_tfidf
INFO:models.baseline_base:Attempting to load intermediate raw text data: SNLI/train/sample100
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/SNLI/train/pairs_sample100.parquet or final path for table 'pairs_sample100'.
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/SNLI/train/sentences_sample100.parquet or final path for table 'sentences_sample100'.
WARNING:models.baseline_base:Intermediate data (pairs_sample100 or sentences_sample100) not found or empty. Falling back to original data loader.
WARNING:models.baseline_base:Executing fallback: Loading original raw data using DatasetLoader.
INFO:data.data_loader:Loading dataset: SNLI (HF: stanfordnlp/snli), Split: train
INFO:data.data_loader:Loading raw SNLI/train from DB table: raw_data_full
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/train/raw_data_full.parquet
INFO:data.data_loader:Loaded 549367 examples for SNLI/train
INFO:models.baseline_base:Fallback data loaded successfully. Shape: (549367, 5)
INFO:models.baseline_base:Attempting to load intermediate raw text data: SNLI/validation/sample100
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/SNLI/validation/pairs_sample100.parquet or final path for table 'pairs_sample100'.
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/SNLI/validation/sentences_sample100.parquet or final path for table 'sentences_sample100'.
WARNING:models.baseline_base:Intermediate data (pairs_sample100 or sentences_sample100) not found or empty. Falling back to original data loader.
WARNING:models.baseline_base:Executing fallback: Loading original raw data using DatasetLoader.
INFO:data.data_loader:Loading dataset: SNLI (HF: stanfordnlp/snli), Split: validation
INFO:data.data_loader:Loading raw SNLI/validation from DB table: raw_data_full
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/validation/raw_data_full.parquet
INFO:data.data_loader:Loaded 9842 examples for SNLI/validation
INFO:models.baseline_base:Fallback data loaded successfully. Shape: (9842, 5)
INFO:models.baseline_base:Attempting to load intermediate raw text data: SNLI/test/sample100
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/SNLI/test/pairs_sample100.parquet or final path for table 'pairs_sample100'.
WARNING:utils.database:No data found at intermediate path /scratch/jywu3/IS567FP/cache/parquet/SNLI/test/sentences_sample100.parquet or final path for table 'sentences_sample100'.
WARNING:models.baseline_base:Intermediate data (pairs_sample100 or sentences_sample100) not found or empty. Falling back to original data loader.
WARNING:models.baseline_base:Executing fallback: Loading original raw data using DatasetLoader.
INFO:data.data_loader:Loading dataset: SNLI (HF: stanfordnlp/snli), Split: test
INFO:data.data_loader:Loading raw SNLI/test from DB table: raw_data_full
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/test/raw_data_full.parquet
INFO:data.data_loader:Loaded 9824 examples for SNLI/test
INFO:models.baseline_base:Fallback data loaded successfully. Shape: (9824, 5)
INFO:models.baseline_trainer:Initializing model: logistic_tfidf
INFO:models.baseline_trainer:Handling logistic_tfidf. Using raw text data.
INFO:models.baseline_trainer:Fitting feature extractor...
INFO:models.baseline_base:Fitting TfidfVectorizer on 549367 combined texts...
INFO:models.baseline_base:TfidfVectorizer fitted. Vocabulary size: 10000
INFO:models.baseline_trainer:Transforming training data...
/var/spool/slurmd/job2003145/slurm_script: line 97: 3263889 Killed                  python -u main.py --dataset "$CURRENT_DATASET" --mode train --model_type "$CURRENT_EXPERIMENT" --sample_size 100
Python script finished with exit code 137 for Task ID 2
------------------------------------------------
Job Task 2 finished.
Total Runtime: 46 seconds
------------------------------------------------
slurmstepd: error: Detected 1 oom_kill event in StepId=2003145.batch. Some of the step tasks have been OOM Killed.
