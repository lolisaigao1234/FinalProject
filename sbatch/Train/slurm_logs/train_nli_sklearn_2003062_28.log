------------------------------------------------
SLURM Job ID: 2009843
SLURM Array Job ID: 2003062
SLURM Array Task ID: 28
Running on host: ccc0366.campuscluster.illinois.edu
Node allocated: ccc0366
Requested CPUs: 16
Requested Memory: M
Running Dataset: ANLI
Running Experiment: logistic_tfidf_syntactic_exp3
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated.
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for ANLI / logistic_tfidf_syntactic_exp3 (Task ID 28)...
INFO:__main__:Running in train mode on ANLI dataset
INFO:__main__:Using device: cpu
INFO:__main__:Selected model type: logistic_tfidf_syntactic_exp3
INFO:__main__:Processing full dataset (no sample size specified).
INFO:__main__:Initializing BaselineTrainer for model: logistic_tfidf_syntactic_exp3, dataset: ANLI
INFO:__main__:Starting training process...
INFO:models.baseline_trainer:Handling training for internally loading model: logistic_tfidf_syntactic_exp3
INFO:models.baseline_trainer:Initializing model: logistic_tfidf_syntactic_exp3
INFO:models.logistic_tfidf_syntactic_experiment_3:Starting Exp3 training for ANLI/train/full
INFO:models.logistic_tfidf_syntactic_experiment_3:Exp3: Loading data for ANLI/train (suffix: full)
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/train/pairs_full.parquet
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/train/sentences_full.parquet
INFO:models.logistic_tfidf_syntactic_experiment_3:Successfully loaded and merged text data. Shape: (162865, 4)
INFO:utils.database:Loading final features data from /scratch/jywu3/IS567FP/cache/parquet/ANLI_train_features_lexical_syntactic_full.parquet
INFO:models.logistic_tfidf_syntactic_experiment_3:Successfully loaded precomputed features. Shape: (740653, 291)
INFO:models.logistic_tfidf_syntactic_experiment_3:Merged text and features: 1883849 rows.
INFO:models.logistic_tfidf_syntactic_experiment_3:Building feature pipeline...
INFO:models.logistic_tfidf_syntactic_experiment_3:Identified 243 syntactic feature columns for pipeline.
INFO:models.logistic_tfidf_syntactic_experiment_3:Feature pipeline built.
INFO:models.logistic_tfidf_syntactic_experiment_3:Fitting feature pipeline on training data...
INFO:models.logistic_tfidf_syntactic_experiment_3:FeatureSelector fit: All 243 potential columns were found in the training data.
INFO:models.logistic_tfidf_syntactic_experiment_3:Training data transformed. Shape: (1883849, 10243)
INFO:models.logistic_tfidf_syntactic_experiment_3:Training Logistic Regression model...
ERROR:models.baseline_trainer:Error during logistic_tfidf_syntactic_exp3 training/saving: Found input variables with inconsistent numbers of samples: [1883849, 162865]
Traceback (most recent call last):
  File "/scratch/jywu3/IS567FP/models/baseline_trainer.py", line 176, in run_training
    train_results = self.model.train(
                    ^^^^^^^^^^^^^^^^^
  File "/scratch/jywu3/IS567FP/models/logistic_tfidf_syntactic_experiment_3.py", line 308, in train
    self.model.fit(X_train_transformed, y_train)
  File "/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/linear_model/_logistic.py", line 1222, in fit
    X, y = validate_data(
           ^^^^^^^^^^^^^^
  File "/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/utils/validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/utils/validation.py", line 1389, in check_X_y
    check_consistent_length(X, y)
  File "/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/utils/validation.py", line 475, in check_consistent_length
    raise ValueError(
ValueError: Found input variables with inconsistent numbers of samples: [1883849, 162865]
ERROR:__main__:Training run failed or produced no results.
Python script finished with exit code 0 for Task ID 28
------------------------------------------------
Job Task 28 finished.
Total Runtime: 137 seconds
------------------------------------------------
