------------------------------------------------
SLURM Job ID: 2009857
SLURM Array Job ID: 2003062
SLURM Array Task ID: 29
Running on host: ccc0366.campuscluster.illinois.edu
Node allocated: ccc0366
Requested CPUs: 16
Requested Memory: M
Running Dataset: ANLI
Running Experiment: mnb_bow_syntactic_exp4
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated.
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for ANLI / mnb_bow_syntactic_exp4 (Task ID 29)...
INFO:__main__:Running in train mode on ANLI dataset
INFO:__main__:Using device: cpu
INFO:__main__:Selected model type: mnb_bow_syntactic_exp4
INFO:__main__:Processing full dataset (no sample size specified).
INFO:__main__:Initializing BaselineTrainer for model: mnb_bow_syntactic_exp4, dataset: ANLI
INFO:__main__:Starting training process...
INFO:models.baseline_trainer:Handling training for internally loading model: mnb_bow_syntactic_exp4
INFO:models.baseline_trainer:Initializing model: mnb_bow_syntactic_exp4
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Starting Exp4 training for ANLI/train/full
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Loading data for ANLI/train (suffix: full)
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/train/pairs_full.parquet
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/train/sentences_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded and merged text data. Shape: (162865, 4)
INFO:utils.database:Loading final features data from /scratch/jywu3/IS567FP/cache/parquet/ANLI_train_features_lexical_syntactic_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded precomputed features. Shape: (740653, 291)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Keeping 243 syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Merged text and syntactic features: 1883849 rows.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Building feature pipeline...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Adding MinMaxScaler for syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Feature pipeline built.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Fitting feature pipeline on training data...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Training data transformed. Shape: (1883849, 10243)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Training Multinomial Naive Bayes model...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Model training completed in 62.15s.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Loading and evaluating on validation data: ANLI/validation/full
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Loading data for ANLI/validation (suffix: full)
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/validation/pairs_full.parquet
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/validation/sentences_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded and merged text data. Shape: (3200, 4)
INFO:utils.database:Loading final features data from /scratch/jywu3/IS567FP/cache/parquet/ANLI_validation_features_lexical_syntactic_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded precomputed features. Shape: (27200, 286)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Keeping 238 syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Merged text and syntactic features: 81200 rows.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Transforming validation data...
WARNING:models.multinomial_naive_bayes_bow_syntactic_experiment_4:FeatureSelector: Columns ['diff_dep_deprel_csubj:outer', 'hypothesis_dep_deprel_csubj:outer', 'hypothesis_dep_deprel_reparandum', 'premise_dep_deprel_csubj:outer', 'premise_dep_deprel_csubj:pass'] not found during transform. Adding columns with 0.
/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/pipeline.py:62: FutureWarning: This Pipeline instance is not fitted yet. Call 'fit' with appropriate arguments before using other methods such as transform, predict, etc. This will raise an error in 1.8 instead of the current warning.
  warnings.warn(
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Evaluating model on validation data...
INFO:models.baseline_base:Evaluating model on 81200 samples...
INFO:models.baseline_base:Prediction finished in 0.04 seconds.
INFO:models.baseline_base:Evaluation Metrics - Accuracy: 0.3268, Precision: 0.3242, Recall: 0.3268, F1: 0.3235
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Saving Exp4 model to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/mnb_bow_syntactic_exp4/full/ANLI_mnb_bow_syntactic_exp4_full_model.joblib, pipeline to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/mnb_bow_syntactic_exp4/full/ANLI_mnb_bow_syntactic_exp4_full_pipeline.joblib, metadata to /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/mnb_bow_syntactic_exp4/full/ANLI_mnb_bow_syntactic_exp4_full_metadata.joblib
INFO:models.baseline_trainer:Starting evaluation: Model=mnb_bow_syntactic_exp4, Dataset=ANLI, Suffix=full
INFO:models.baseline_trainer:Loading mnb_bow_syntactic_exp4 model from base path /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/mnb_bow_syntactic_exp4/full/ANLI_mnb_bow_syntactic_exp4_full for evaluation...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Loading Exp4 model from /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/mnb_bow_syntactic_exp4/full/ANLI_mnb_bow_syntactic_exp4_full_model.joblib, pipeline from /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/mnb_bow_syntactic_exp4/full/ANLI_mnb_bow_syntactic_exp4_full_pipeline.joblib, metadata from /scratch/jywu3/IS567FP/saved_models/baseline_models/ANLI/mnb_bow_syntactic_exp4/full/ANLI_mnb_bow_syntactic_exp4_full_metadata.joblib
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4 Model loaded successfully.
INFO:models.baseline_trainer:Triggering internal evaluation for mnb_bow_syntactic_exp4...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Loading data for ANLI/test (suffix: full)
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/test/pairs_full.parquet
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/ANLI/test/sentences_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded and merged text data. Shape: (3200, 4)
INFO:utils.database:Loading final features data from /scratch/jywu3/IS567FP/cache/parquet/ANLI_test_features_lexical_syntactic_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded precomputed features. Shape: (27200, 288)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Keeping 240 syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Merged text and syntactic features: 81200 rows.
WARNING:models.multinomial_naive_bayes_bow_syntactic_experiment_4:FeatureSelector: Columns ['hypothesis_dep_deprel_orphan', 'hypothesis_dep_deprel_reparandum', 'premise_dep_deprel_csubj:outer'] not found during transform. Adding columns with 0.
/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/pipeline.py:62: FutureWarning: This Pipeline instance is not fitted yet. Call 'fit' with appropriate arguments before using other methods such as transform, predict, etc. This will raise an error in 1.8 instead of the current warning.
  warnings.warn(
INFO:models.baseline_base:Evaluating model on 81200 samples...
INFO:models.baseline_base:Prediction finished in 0.04 seconds.
INFO:models.baseline_base:Evaluation Metrics - Accuracy: 0.3376, Precision: 0.3351, Recall: 0.3376, F1: 0.3346
INFO:models.baseline_trainer:Evaluation results for mnb_bow_syntactic_exp4: {'accuracy': 0.3376108374384236, 'precision': 0.3350653951530054, 'recall': 0.3376108374384236, 'f1': 0.33458808701188}
INFO:__main__:Training finished. Results: {'mnb_bow_syntactic_exp4': {'train_time': 62.149381160736084, 'accuracy': 0.3267610837438424, 'precision': 0.32415228238583615, 'recall': 0.3267610837438424, 'f1': 0.323486661653412, 'eval_time': 0.03723597526550293}}
Python script finished with exit code 0 for Task ID 29
------------------------------------------------
Job Task 29 finished.
Total Runtime: 81 seconds
------------------------------------------------
