------------------------------------------------
SLURM Job ID: 2004746
SLURM Array Job ID: 2003062
SLURM Array Task ID: 7
Running on host: ccc0288.campuscluster.illinois.edu
Node allocated: ccc0288
Requested CPUs: 16
Requested Memory: M
Running Dataset: SNLI
Running Experiment: mnb_bow_syntactic_exp4
------------------------------------------------
Modules loaded.
Python environment 'IS567' activated.
OMP_NUM_THREADS set to 16
Changed directory to /u/jywu3/scratch/IS567FP
Starting Python script for SNLI / mnb_bow_syntactic_exp4 (Task ID 7)...
INFO:__main__:Running in train mode on SNLI dataset
INFO:__main__:Using device: cpu
INFO:__main__:Selected model type: mnb_bow_syntactic_exp4
INFO:__main__:Processing full dataset (no sample size specified).
INFO:__main__:Initializing BaselineTrainer for model: mnb_bow_syntactic_exp4, dataset: SNLI
INFO:__main__:Starting training process...
INFO:models.baseline_trainer:Handling training for internally loading model: mnb_bow_syntactic_exp4
INFO:models.baseline_trainer:Initializing model: mnb_bow_syntactic_exp4
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Starting Exp4 training for SNLI/train/full
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Loading data for SNLI/train (suffix: full)
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/train/pairs_full.parquet
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/train/sentences_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded and merged text data. Shape: (549367, 4)
INFO:utils.database:Loading final features data from /scratch/jywu3/IS567FP/cache/parquet/SNLI_train_features_lexical_syntactic_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded precomputed features. Shape: (549367, 288)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Keeping 240 syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Merged text and syntactic features: 549367 rows.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Building feature pipeline...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Adding MinMaxScaler for syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Feature pipeline built.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Fitting feature pipeline on training data...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Training data transformed. Shape: (549367, 10240)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Training Multinomial Naive Bayes model...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Model training completed in 13.31s.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Loading and evaluating on validation data: SNLI/validation/full
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Loading data for SNLI/validation (suffix: full)
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/validation/pairs_full.parquet
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/validation/sentences_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded and merged text data. Shape: (9842, 4)
INFO:utils.database:Loading final features data from /scratch/jywu3/IS567FP/cache/parquet/SNLI_validation_features_lexical_syntactic_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded precomputed features. Shape: (9842, 274)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Keeping 226 syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Merged text and syntactic features: 9842 rows.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Transforming validation data...
WARNING:models.multinomial_naive_bayes_bow_syntactic_experiment_4:FeatureSelector: Columns ['diff_dep_deprel_csubj:outer', 'diff_dep_deprel_csubj:pass', 'diff_dep_deprel_list', 'diff_dep_pos_X', 'hypothesis_dep_deprel_csubj:outer', 'hypothesis_dep_deprel_csubj:pass', 'hypothesis_dep_deprel_dislocated', 'hypothesis_dep_deprel_list', 'hypothesis_dep_deprel_orphan', 'hypothesis_dep_pos_X', 'premise_dep_deprel_dep', 'premise_dep_deprel_nsubj:outer', 'premise_dep_deprel_vocative', 'premise_dep_pos_X'] not found during transform. Adding columns with 0.
/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/pipeline.py:62: FutureWarning: This Pipeline instance is not fitted yet. Call 'fit' with appropriate arguments before using other methods such as transform, predict, etc. This will raise an error in 1.8 instead of the current warning.
  warnings.warn(
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Evaluating model on validation data...
INFO:models.baseline_base:Evaluating model on 9842 samples...
INFO:models.baseline_base:Prediction finished in 0.00 seconds.
INFO:models.baseline_base:Evaluation Metrics - Accuracy: 0.5977, Precision: 0.6006, Recall: 0.5977, F1: 0.5971
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Saving Exp4 model to /scratch/jywu3/IS567FP/saved_models/baseline_models/SNLI/mnb_bow_syntactic_exp4/full/SNLI_mnb_bow_syntactic_exp4_full_model.joblib, pipeline to /scratch/jywu3/IS567FP/saved_models/baseline_models/SNLI/mnb_bow_syntactic_exp4/full/SNLI_mnb_bow_syntactic_exp4_full_pipeline.joblib, metadata to /scratch/jywu3/IS567FP/saved_models/baseline_models/SNLI/mnb_bow_syntactic_exp4/full/SNLI_mnb_bow_syntactic_exp4_full_metadata.joblib
INFO:models.baseline_trainer:Starting evaluation: Model=mnb_bow_syntactic_exp4, Dataset=SNLI, Suffix=full
INFO:models.baseline_trainer:Loading mnb_bow_syntactic_exp4 model from base path /scratch/jywu3/IS567FP/saved_models/baseline_models/SNLI/mnb_bow_syntactic_exp4/full/SNLI_mnb_bow_syntactic_exp4_full for evaluation...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Loading Exp4 model from /scratch/jywu3/IS567FP/saved_models/baseline_models/SNLI/mnb_bow_syntactic_exp4/full/SNLI_mnb_bow_syntactic_exp4_full_model.joblib, pipeline from /scratch/jywu3/IS567FP/saved_models/baseline_models/SNLI/mnb_bow_syntactic_exp4/full/SNLI_mnb_bow_syntactic_exp4_full_pipeline.joblib, metadata from /scratch/jywu3/IS567FP/saved_models/baseline_models/SNLI/mnb_bow_syntactic_exp4/full/SNLI_mnb_bow_syntactic_exp4_full_metadata.joblib
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4 Model loaded successfully.
INFO:models.baseline_trainer:Triggering internal evaluation for mnb_bow_syntactic_exp4...
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Loading data for SNLI/test (suffix: full)
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/test/pairs_full.parquet
INFO:utils.database:Loading intermediate data from /scratch/jywu3/IS567FP/cache/parquet/SNLI/test/sentences_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded and merged text data. Shape: (9824, 4)
INFO:utils.database:Loading final features data from /scratch/jywu3/IS567FP/cache/parquet/SNLI_test_features_lexical_syntactic_full.parquet
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Successfully loaded precomputed features. Shape: (9824, 280)
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Keeping 232 syntactic features.
INFO:models.multinomial_naive_bayes_bow_syntactic_experiment_4:Exp4: Merged text and syntactic features: 9824 rows.
WARNING:models.multinomial_naive_bayes_bow_syntactic_experiment_4:FeatureSelector: Columns ['diff_dep_deprel_csubj:pass', 'diff_dep_deprel_list', 'hypothesis_dep_deprel_csubj:pass', 'hypothesis_dep_deprel_list', 'hypothesis_dep_deprel_orphan', 'premise_dep_deprel_dislocated', 'premise_dep_pos_SYM', 'premise_dep_pos_X'] not found during transform. Adding columns with 0.
/u/jywu3/.conda/envs/IS567/lib/python3.12/site-packages/sklearn/pipeline.py:62: FutureWarning: This Pipeline instance is not fitted yet. Call 'fit' with appropriate arguments before using other methods such as transform, predict, etc. This will raise an error in 1.8 instead of the current warning.
  warnings.warn(
INFO:models.baseline_base:Evaluating model on 9824 samples...
INFO:models.baseline_base:Prediction finished in 0.00 seconds.
INFO:models.baseline_base:Evaluation Metrics - Accuracy: 0.6002, Precision: 0.6026, Recall: 0.6002, F1: 0.5996
INFO:models.baseline_trainer:Evaluation results for mnb_bow_syntactic_exp4: {'accuracy': 0.6001628664495114, 'precision': 0.6025984623646262, 'recall': 0.6001628664495114, 'f1': 0.599643359954052}
INFO:__main__:Training finished. Results: {'mnb_bow_syntactic_exp4': {'train_time': 13.313415050506592, 'accuracy': 0.5977443609022557, 'precision': 0.600599909204287, 'recall': 0.5977443609022557, 'f1': 0.597069070892453, 'eval_time': 0.0036497116088867188}}
Python script finished with exit code 0 for Task ID 7
------------------------------------------------
Job Task 7 finished.
Total Runtime: 32 seconds
------------------------------------------------
